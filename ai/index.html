
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Python package for interactive mapping with Google Earth Engine">
      
      
        <meta name="author" content="Qiusheng Wu">
      
      
        <link rel="canonical" href="https://geemap.org/ai/">
      
      
        <link rel="prev" href="../changelog/">
      
      
        <link rel="next" href="../basemaps/">
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>ai module - geemap</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Google+Sans:300,300i,400,400i,700,700i%7CRegular:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Google Sans";--md-code-font:"Regular"}</style>
      
    
    
      <link rel="stylesheet" href="../css/timeago.css">
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-H322CB6ZEC"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-H322CB6ZEC",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-H322CB6ZEC",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ai-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="geemap" class="md-header__button md-logo" aria-label="geemap" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            geemap
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              ai module
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/gee-community/geemap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="geemap" class="md-nav__button md-logo" aria-label="geemap" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    geemap
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/gee-community/geemap" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://book.geemap.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Book
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../get-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get Started
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cheat Sheet
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://courses.geemap.org" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Courses
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../citations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Citations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://youtube.com/@giswqs" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YouTube Channel
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/gee-community/geemap/issues" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Report Issues
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" checked>
        
          
          <label class="md-nav__link" for="__nav_15" id="__nav_15_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    ai module
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    ai module
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#geemap.ai" class="md-nav__link">
    <span class="md-ellipsis">
      geemap.ai
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.BBox" class="md-nav__link">
    <span class="md-ellipsis">
      BBox
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BBox">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.BBox.from_list" class="md-nav__link">
    <span class="md-ellipsis">
      from_list()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.BBox.intersects" class="md-nav__link">
    <span class="md-ellipsis">
      intersects()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.BBox.is_global" class="md-nav__link">
    <span class="md-ellipsis">
      is_global()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.BBox.to_list" class="md-nav__link">
    <span class="md-ellipsis">
      to_list()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.Catalog" class="md-nav__link">
    <span class="md-ellipsis">
      Catalog
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Catalog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Catalog.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Catalog.get_collection" class="md-nav__link">
    <span class="md-ellipsis">
      get_collection()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.Collection" class="md-nav__link">
    <span class="md-ellipsis">
      Collection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Collection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.bands" class="md-nav__link">
    <span class="md-ellipsis">
      bands()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.bbox_list" class="md-nav__link">
    <span class="md-ellipsis">
      bbox_list()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.catalog_url" class="md-nav__link">
    <span class="md-ellipsis">
      catalog_url()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.datetime_interval" class="md-nav__link">
    <span class="md-ellipsis">
      datetime_interval()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.end" class="md-nav__link">
    <span class="md-ellipsis">
      end()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.end_str" class="md-nav__link">
    <span class="md-ellipsis">
      end_str()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.get" class="md-nav__link">
    <span class="md-ellipsis">
      get()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.get_dataset_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_dataset_type()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.hyphen_id" class="md-nav__link">
    <span class="md-ellipsis">
      hyphen_id()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.image_preview_url" class="md-nav__link">
    <span class="md-ellipsis">
      image_preview_url()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.is_deprecated" class="md-nav__link">
    <span class="md-ellipsis">
      is_deprecated()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.public_id" class="md-nav__link">
    <span class="md-ellipsis">
      public_id()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.python_code" class="md-nav__link">
    <span class="md-ellipsis">
      python_code()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.set_js_code" class="md-nav__link">
    <span class="md-ellipsis">
      set_js_code()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.set_python_code" class="md-nav__link">
    <span class="md-ellipsis">
      set_python_code()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.spatial_resolution_m" class="md-nav__link">
    <span class="md-ellipsis">
      spatial_resolution_m()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.start" class="md-nav__link">
    <span class="md-ellipsis">
      start()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.start_str" class="md-nav__link">
    <span class="md-ellipsis">
      start_str()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.temporal_resolution_str" class="md-nav__link">
    <span class="md-ellipsis">
      temporal_resolution_str()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList" class="md-nav__link">
    <span class="md-ellipsis">
      CollectionList
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CollectionList">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.filter_by_bounding_box" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_bounding_box()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.filter_by_bounding_box_list" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_bounding_box_list()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.filter_by_datetime" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_datetime()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.filter_by_ids" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_ids()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.filter_by_interval" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_interval()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.limit" class="md-nav__link">
    <span class="md-ellipsis">
      limit()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.sort_by_spatial_resolution" class="md-nav__link">
    <span class="md-ellipsis">
      sort_by_spatial_resolution()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.to_df" class="md-nav__link">
    <span class="md-ellipsis">
      to_df()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.DatasetExplorer" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetExplorer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetExplorer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.DatasetExplorer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.DatasetExplorer.show" class="md-nav__link">
    <span class="md-ellipsis">
      show()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.DatasetSearchInterface" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetSearchInterface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetSearchInterface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.DatasetSearchInterface.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.DatasetSearchInterface.display" class="md-nav__link">
    <span class="md-ellipsis">
      display()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.DatasetSearchInterface.update_outputs" class="md-nav__link">
    <span class="md-ellipsis">
      update_outputs()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.EarthEngineDatasetIndex" class="md-nav__link">
    <span class="md-ellipsis">
      EarthEngineDatasetIndex
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EarthEngineDatasetIndex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.EarthEngineDatasetIndex.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.EarthEngineDatasetIndex.find_top_matches" class="md-nav__link">
    <span class="md-ellipsis">
      find_top_matches()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.EarthEngineDatasetIndex.find_top_matches_with_score_df" class="md-nav__link">
    <span class="md-ellipsis">
      find_top_matches_with_score_df()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.EarthEngineDatasetIndex.ids_to_match_scores_df" class="md-nav__link">
    <span class="md-ellipsis">
      ids_to_match_scores_df()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.Genie" class="md-nav__link">
    <span class="md-ellipsis">
      Genie
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.PrecomputedEmbeddings" class="md-nav__link">
    <span class="md-ellipsis">
      PrecomputedEmbeddings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PrecomputedEmbeddings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.PrecomputedEmbeddings.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.PrecomputedEmbeddings.embed_documents" class="md-nav__link">
    <span class="md-ellipsis">
      embed_documents()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.PrecomputedEmbeddings.embed_query" class="md-nav__link">
    <span class="md-ellipsis">
      embed_query()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.explain_relevance" class="md-nav__link">
    <span class="md-ellipsis">
      explain_relevance()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.explain_relevance_from_stac_json" class="md-nav__link">
    <span class="md-ellipsis">
      explain_relevance_from_stac_json()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.fix_ee_python_code" class="md-nav__link">
    <span class="md-ellipsis">
      fix_ee_python_code()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.is_valid_question" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid_question()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.make_langchain_index" class="md-nav__link">
    <span class="md-ellipsis">
      make_langchain_index()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.matches_datetime" class="md-nav__link">
    <span class="md-ellipsis">
      matches_datetime()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.matches_interval" class="md-nav__link">
    <span class="md-ellipsis">
      matches_interval()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.run_ee_code" class="md-nav__link">
    <span class="md-ellipsis">
      run_ee_code()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../basemaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    basemaps module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cartoee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cartoee module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    chart module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../colormaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    colormaps module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../common/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    common module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conversion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    conversion module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    core module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coreutils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coreutils module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    datasets module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../deck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    deck module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ee_tile_layers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ee_tile_layers module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    examples module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../foliumap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    foliumap module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geemap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    geemap module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../kepler/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kepler module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../legends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    legends module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../map_widgets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    map_widgets module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../maplibregl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    maplibregl module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ml module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../osm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    osm module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plot module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plotlymap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    plotlymap module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../report/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    report module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    timelapse module
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../toolbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    toolbar module
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          <label class="md-nav__link" for="__nav_16" id="__nav_16_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Workshops
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            Workshops
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GeoPython_2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoPython 2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GEE_Workshop_2021/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GEE Workshop 2021
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/SRM_Workshop_2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SRM Workshop 2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Crop_Mapping_2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crop Mapping 2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Japan_2022/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Japan 2022
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GEE_Workshop_2022_Part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GEE Workshop 2022 Part1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GEE_Workshop_2022_Part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GEE Workshop 2022 Part2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/AmericaView_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AmericaView 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/SciPy_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SciPy 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/City_Plus_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    City Plus 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/G4G_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    G4G 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/NCSU_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NCSU 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/AGU_2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AGU 2023
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Alaska_2024_Part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alaska 2024 Part1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Alaska_2024_Part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alaska 2024 Part2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Alaska_2024_Part3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Alaska 2024 Part3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GEE_Workshop_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GEE Workshop 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/TNGIC_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TNGIC 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/IGIC_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IGIC 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/SciPy_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SciPy 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/SatMOC_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SatMOC 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/GeoAI_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GeoAI 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/Taiwan_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Taiwan 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/FOSS4GNA_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FOSS4GNA 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/IPPN_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IPPN 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/HGAC_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HGAC 2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workshops/AGU_2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AGU 2024
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_17" >
        
          
          <label class="md-nav__link" for="__nav_17" id="__nav_17_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Notebooks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_17">
            <span class="md-nav__icon md-icon"></span>
            Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/00_ee_auth_colab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00 ee auth colab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/00_geemap_colab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00 geemap colab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/00_geemap_key_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00 geemap key features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/01_geemap_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01 geemap intro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/02_using_basemaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02 using basemaps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/03_inspector_tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03 inspector tool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/04_split_panel_map/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04 split panel map
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/05_drawing_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05 drawing tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/06_marker_cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    06 marker cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/07_geojson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    07 geojson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/08_ee_js_to_ipynb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    08 ee js to ipynb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/09_plotting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    09 plotting
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/10_shapefiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    10 shapefiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/11_export_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    11 export image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/12_zonal_statistics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    12 zonal statistics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/13_zonal_statistics_by_group/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    13 zonal statistics by group
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/14_legends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    14 legends
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/15_convert_js_to_py/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    15 convert js to py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/16_add_animated_text/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    16 add animated text
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/17_add_colorbar_to_gif/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    17 add colorbar to gif
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/18_create_landsat_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    18 create landsat timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/19_search_places_and_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    19 search places and datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/20_timeseries_inspector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    20 timeseries inspector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/21_export_map_to_html_png/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    21 export map to html png
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/22_import_scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    22 import scripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/23_import_assets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    23 import assets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/24_publish_maps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    24 publish maps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/25_load_rasters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    25 load rasters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/26_heroku/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    26 heroku
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/27_timelapse_app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    27 timelapse app
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/28_voila/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    28 voila
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/29_pydeck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    29 pydeck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/30_image_props_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    30 image props stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/31_unsupervised_classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    31 unsupervised classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/32_supervised_classification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    32 supervised classification
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/33_accuracy_assessment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    33 accuracy assessment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/34_extract_values/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    34 extract values
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/35_geemap_colab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    35 geemap colab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/36_quality_mosaic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    36 quality mosaic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/37_pydeck_3d/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    37 pydeck 3d
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/38_cloud_geotiff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    38 cloud geotiff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/39_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    39 timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/40_ipywidgets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    40 ipywidgets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/41_water_app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    41 water app
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/42_upload_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    42 upload data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/43_extract_values_to_points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    43 extract values to points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/44_cog_stac/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    44 cog stac
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/45_cog_mosaic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    45 cog mosaic
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/46_local_rf_training/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    46 local rf training
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/47_image_thumbnails/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    47 image thumbnails
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/48_folium_legend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    48 folium legend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/49_colorbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    49 colorbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/50_cartoee_quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    50 cartoee quickstart
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/51_cartoee_projections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    51 cartoee projections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/52_cartoee_gif/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    52 cartoee gif
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/53_layer_vis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    53 layer vis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/54_vector_vis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    54 vector vis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/55_raster_vis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    55 raster vis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/56_local_data/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    56 local data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/57_cartoee_blend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    57 cartoee blend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/58_add_vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    58 add vector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/59_whitebox/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    59 whitebox
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/60_colormaps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    60 colormaps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/61_cartoee_scalebar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    61 cartoee scalebar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/62_time_slider/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    62 time slider
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/63_charts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    63 charts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/64_data_catalog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    64 data catalog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/65_vector_styling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    65 vector styling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/66_cartoee_legend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    66 cartoee legend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/67_training_samples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    67 training samples
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/68_netcdf_to_ee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    68 netcdf to ee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/69_cartoee_vector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    69 cartoee vector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/70_linked_maps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    70 linked maps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/71_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    71 timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/72_time_slider_gui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    72 time slider gui
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/73_transect/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    73 transect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/74_csv_to_points/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    74 csv to points
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/75_sankee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    75 sankee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/76_osm_to_ee/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    76 osm to ee
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/77_planet_imagery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    77 planet imagery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/78_ts_inspector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    78 ts inspector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/79_chart_histogram/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    79 chart histogram
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/80_point_layer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    80 point layer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/81_goes_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    81 goes timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/82_contours/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    82 contours
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/83_local_tile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    83 local tile
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/84_openstreetmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    84 openstreetmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/85_postgis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    85 postgis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/86_image_overlay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    86 image overlay
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/87_add_points_from_xy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    87 add points from xy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/88_circle_markers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    88 circle markers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/89_add_labels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    89 add labels
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/90_naip_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    90 naip timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/91_planetary_computer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    91 planetary computer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/92_plotly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    92 plotly
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/93_cog_inspector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    93 cog inspector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/94_heremap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    94 heremap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/95_create_cog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    95 create cog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/96_image_chips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    96 image chips
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/97_join_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    97 join table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/98_timelapse_fading/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    98 timelapse fading
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/99_landsat_9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    99 landsat 9
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/100_numpy_to_cog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    100 numpy to cog
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/101_lidar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    101 lidar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/102_blend_hillshade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    102 blend hillshade
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/103_split_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    103 split control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/104_clip_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    104 clip image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/105_netcdf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    105 netcdf
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/106_kepler_gl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    106 kepler gl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/107_pydeck/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    107 pydeck
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/108_image_zonal_stats/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    108 image zonal stats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/109_coordinate_grids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    109 coordinate grids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/110_choropleth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    110 choropleth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/111_image_count/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    111 image count
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/112_cartoee_basemap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    112 cartoee basemap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/113_image_area/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    113 image area
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/114_dynamic_world/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    114 dynamic world
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/115_land_cover/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    115 land cover
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/116_land_cover_timeseries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    116 land cover timeseries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/117_fishnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    117 fishnet
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/118_download_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    118 download image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/119_plot_raster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    119 plot raster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/120_javascript/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    120 javascript
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/121_vector_style/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    121 vector style
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/122_lidar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    122 lidar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/123_sentinel1_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    123 sentinel1 timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/124_more_datasets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    124 more datasets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/125_example_code/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    125 example code
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/126_inspector/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    126 inspector
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/127_create_legend/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    127 create legend
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/128_add_widget/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    128 add widget
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/129_vector_to_gif/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    129 vector to gif
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/130_print_objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    130 print objects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/131_arcgis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    131 arcgis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/132_folium_colorbar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    132 folium colorbar
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/133_gradio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    133 gradio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/134_ee_to_geotiff/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    134 ee to geotiff
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/135_segmentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    135 segmentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/136_download_parallel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    136 download parallel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/137_create_grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    137 create grid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/138_draw_control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    138 draw control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/139_layer_to_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    139 layer to image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/140_ee_to_xarray/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    140 ee to xarray
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/141_image_array_viz/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    141 image array viz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/142_google_maps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    142 google maps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/143_precipitation_timelapse/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    143 precipitation timelapse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/144_chart_features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    144 chart features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/145_chart_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    145 chart image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/146_chart_image_collection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    146 chart image collection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/147_chart_array_list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    147 chart array list
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/148_chart_data_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    148 chart data table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/149_gemini/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    149 gemini
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/150_maplibre/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    150 maplibre
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks/151_dataset_explorer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    151 dataset explorer
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#geemap.ai" class="md-nav__link">
    <span class="md-ellipsis">
      geemap.ai
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.BBox" class="md-nav__link">
    <span class="md-ellipsis">
      BBox
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BBox">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.BBox.from_list" class="md-nav__link">
    <span class="md-ellipsis">
      from_list()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.BBox.intersects" class="md-nav__link">
    <span class="md-ellipsis">
      intersects()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.BBox.is_global" class="md-nav__link">
    <span class="md-ellipsis">
      is_global()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.BBox.to_list" class="md-nav__link">
    <span class="md-ellipsis">
      to_list()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.Catalog" class="md-nav__link">
    <span class="md-ellipsis">
      Catalog
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Catalog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Catalog.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Catalog.get_collection" class="md-nav__link">
    <span class="md-ellipsis">
      get_collection()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.Collection" class="md-nav__link">
    <span class="md-ellipsis">
      Collection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Collection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.__getitem__" class="md-nav__link">
    <span class="md-ellipsis">
      __getitem__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.bands" class="md-nav__link">
    <span class="md-ellipsis">
      bands()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.bbox_list" class="md-nav__link">
    <span class="md-ellipsis">
      bbox_list()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.catalog_url" class="md-nav__link">
    <span class="md-ellipsis">
      catalog_url()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.datetime_interval" class="md-nav__link">
    <span class="md-ellipsis">
      datetime_interval()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.end" class="md-nav__link">
    <span class="md-ellipsis">
      end()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.end_str" class="md-nav__link">
    <span class="md-ellipsis">
      end_str()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.get" class="md-nav__link">
    <span class="md-ellipsis">
      get()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.get_dataset_type" class="md-nav__link">
    <span class="md-ellipsis">
      get_dataset_type()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.hyphen_id" class="md-nav__link">
    <span class="md-ellipsis">
      hyphen_id()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.image_preview_url" class="md-nav__link">
    <span class="md-ellipsis">
      image_preview_url()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.is_deprecated" class="md-nav__link">
    <span class="md-ellipsis">
      is_deprecated()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.public_id" class="md-nav__link">
    <span class="md-ellipsis">
      public_id()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.python_code" class="md-nav__link">
    <span class="md-ellipsis">
      python_code()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.set_js_code" class="md-nav__link">
    <span class="md-ellipsis">
      set_js_code()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.set_python_code" class="md-nav__link">
    <span class="md-ellipsis">
      set_python_code()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.spatial_resolution_m" class="md-nav__link">
    <span class="md-ellipsis">
      spatial_resolution_m()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.start" class="md-nav__link">
    <span class="md-ellipsis">
      start()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.start_str" class="md-nav__link">
    <span class="md-ellipsis">
      start_str()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.Collection.temporal_resolution_str" class="md-nav__link">
    <span class="md-ellipsis">
      temporal_resolution_str()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList" class="md-nav__link">
    <span class="md-ellipsis">
      CollectionList
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CollectionList">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.filter_by_bounding_box" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_bounding_box()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.filter_by_bounding_box_list" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_bounding_box_list()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.filter_by_datetime" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_datetime()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.filter_by_ids" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_ids()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.filter_by_interval" class="md-nav__link">
    <span class="md-ellipsis">
      filter_by_interval()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.limit" class="md-nav__link">
    <span class="md-ellipsis">
      limit()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.sort_by_spatial_resolution" class="md-nav__link">
    <span class="md-ellipsis">
      sort_by_spatial_resolution()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.CollectionList.to_df" class="md-nav__link">
    <span class="md-ellipsis">
      to_df()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.DatasetExplorer" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetExplorer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetExplorer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.DatasetExplorer.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.DatasetExplorer.show" class="md-nav__link">
    <span class="md-ellipsis">
      show()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.DatasetSearchInterface" class="md-nav__link">
    <span class="md-ellipsis">
      DatasetSearchInterface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DatasetSearchInterface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.DatasetSearchInterface.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.DatasetSearchInterface.display" class="md-nav__link">
    <span class="md-ellipsis">
      display()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.DatasetSearchInterface.update_outputs" class="md-nav__link">
    <span class="md-ellipsis">
      update_outputs()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.EarthEngineDatasetIndex" class="md-nav__link">
    <span class="md-ellipsis">
      EarthEngineDatasetIndex
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EarthEngineDatasetIndex">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.EarthEngineDatasetIndex.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.EarthEngineDatasetIndex.find_top_matches" class="md-nav__link">
    <span class="md-ellipsis">
      find_top_matches()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.EarthEngineDatasetIndex.find_top_matches_with_score_df" class="md-nav__link">
    <span class="md-ellipsis">
      find_top_matches_with_score_df()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.EarthEngineDatasetIndex.ids_to_match_scores_df" class="md-nav__link">
    <span class="md-ellipsis">
      ids_to_match_scores_df()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.Genie" class="md-nav__link">
    <span class="md-ellipsis">
      Genie
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.PrecomputedEmbeddings" class="md-nav__link">
    <span class="md-ellipsis">
      PrecomputedEmbeddings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PrecomputedEmbeddings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geemap.ai.PrecomputedEmbeddings.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.PrecomputedEmbeddings.embed_documents" class="md-nav__link">
    <span class="md-ellipsis">
      embed_documents()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#geemap.ai.PrecomputedEmbeddings.embed_query" class="md-nav__link">
    <span class="md-ellipsis">
      embed_query()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.explain_relevance" class="md-nav__link">
    <span class="md-ellipsis">
      explain_relevance()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.explain_relevance_from_stac_json" class="md-nav__link">
    <span class="md-ellipsis">
      explain_relevance_from_stac_json()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.fix_ee_python_code" class="md-nav__link">
    <span class="md-ellipsis">
      fix_ee_python_code()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.is_valid_question" class="md-nav__link">
    <span class="md-ellipsis">
      is_valid_question()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.make_langchain_index" class="md-nav__link">
    <span class="md-ellipsis">
      make_langchain_index()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.matches_datetime" class="md-nav__link">
    <span class="md-ellipsis">
      matches_datetime()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.matches_interval" class="md-nav__link">
    <span class="md-ellipsis">
      matches_interval()
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geemap.ai.run_ee_code" class="md-nav__link">
    <span class="md-ellipsis">
      run_ee_code()
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                



                  

  
  


<h1 id="ai-module">ai module<a class="headerlink" href="#ai-module" title="Permanent link">&para;</a></h1>


  <div class="doc doc-object doc-module">

<a id="geemap.ai"></a>
    <div class="doc doc-contents first">

      <p>This module contains functions for interacting with AI models.
The Genie class source code is adapted from the ee_genie.ipynb at <a href="https://bit.ly/3YEm7B6">https://bit.ly/3YEm7B6</a>.
Credit to the original author Simon Ilyushchenko (<a href="https://github.com/simonff">https://github.com/simonff</a>).
The DataExplorer class source code is adapted from <a href="https://bit.ly/48cE24D">https://bit.ly/48cE24D</a>.
Credit to the original author Renee Johnston (<a href="https://github.com/raj02006">https://github.com/raj02006</a>)</p>



  <div class="doc doc-children">







  <div class="doc doc-object doc-class">



<h2 id="geemap.ai.BBox" class="doc doc-heading">
        <code>
BBox        </code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-dataclass"><code>dataclass</code></small>
  </span>

<a href="#geemap.ai.BBox" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Class representing a lat/lon bounding box.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@dataclasses</span><span class="o">.</span><span class="n">dataclass</span>
<span class="k">class</span> <span class="nc">BBox</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class representing a lat/lon bounding box.&quot;&quot;&quot;</span>

    <span class="n">west</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">south</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">east</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">north</span><span class="p">:</span> <span class="nb">float</span>

    <span class="k">def</span> <span class="nf">is_global</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if the bounding box is global.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the bounding box is global, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">west</span> <span class="o">==</span> <span class="o">-</span><span class="mi">180</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">south</span> <span class="o">==</span> <span class="o">-</span><span class="mi">90</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">east</span> <span class="o">==</span> <span class="mi">180</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">north</span> <span class="o">==</span> <span class="mi">90</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bbox_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;BBox&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructs a BBox from a list of four numbers [west, south, east, north].</span>

<span class="sd">        Args:</span>
<span class="sd">            bbox_list (List[float]): List of four numbers representing the bounding box.</span>

<span class="sd">        Returns:</span>
<span class="sd">            BBox: The constructed BBox object.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the coordinates are not in the correct order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The smaller (west) coordinate must be listed first in a bounding box&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; corner list. Found </span><span class="si">{</span><span class="n">bbox_list</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;The smaller (south) coordinate must be listed first in a bounding&quot;</span>
                <span class="sa">f</span><span class="s2">&quot; box corner list. Found </span><span class="si">{</span><span class="n">bbox_list</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts the BBox to a list of four numbers [west, south, east, north].</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[float]: List of four numbers representing the bounding box.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">west</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">south</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">north</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">intersects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_bbox</span><span class="p">:</span> <span class="s2">&quot;BBox&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if this bbox intersects with the query bbox.</span>

<span class="sd">        Doesn&#39;t handle bboxes extending past the antimeridian.</span>

<span class="sd">        Args:</span>
<span class="sd">            query_bbox (BBox): Bounding box from the query.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the two bounding boxes intersect, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">query_bbox</span><span class="o">.</span><span class="n">west</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">east</span>
            <span class="ow">and</span> <span class="n">query_bbox</span><span class="o">.</span><span class="n">east</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">west</span>
            <span class="ow">and</span> <span class="n">query_bbox</span><span class="o">.</span><span class="n">south</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">north</span>
            <span class="ow">and</span> <span class="n">query_bbox</span><span class="o">.</span><span class="n">north</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">south</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">
















  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.BBox.from_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">from_list</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-classmethod"><code>classmethod</code></small>
  </span>

<a href="#geemap.ai.BBox.from_list" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Constructs a BBox from a list of four numbers [west, south, east, north].</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>bbox_list</code></td>
        <td><code>List[float]</code></td>
        <td><p>List of four numbers representing the bounding box.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>BBox</code></td>
      <td><p>The constructed BBox object.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the coordinates are not in the correct order.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_list</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">bbox_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;BBox&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constructs a BBox from a list of four numbers [west, south, east, north].</span>

<span class="sd">    Args:</span>
<span class="sd">        bbox_list (List[float]): List of four numbers representing the bounding box.</span>

<span class="sd">    Returns:</span>
<span class="sd">        BBox: The constructed BBox object.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the coordinates are not in the correct order.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The smaller (west) coordinate must be listed first in a bounding box&quot;</span>
            <span class="sa">f</span><span class="s2">&quot; corner list. Found </span><span class="si">{</span><span class="n">bbox_list</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;The smaller (south) coordinate must be listed first in a bounding&quot;</span>
            <span class="sa">f</span><span class="s2">&quot; box corner list. Found </span><span class="si">{</span><span class="n">bbox_list</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">bbox_list</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">bbox_list</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.BBox.intersects" class="doc doc-heading">
<code class="highlight language-python"><span class="n">intersects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_bbox</span><span class="p">)</span></code>


<a href="#geemap.ai.BBox.intersects" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Checks if this bbox intersects with the query bbox.</p>
<p>Doesn't handle bboxes extending past the antimeridian.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query_bbox</code></td>
        <td><code>BBox</code></td>
        <td><p>Bounding box from the query.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the two bounding boxes intersect, False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">intersects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_bbox</span><span class="p">:</span> <span class="s2">&quot;BBox&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if this bbox intersects with the query bbox.</span>

<span class="sd">    Doesn&#39;t handle bboxes extending past the antimeridian.</span>

<span class="sd">    Args:</span>
<span class="sd">        query_bbox (BBox): Bounding box from the query.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the two bounding boxes intersect, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">query_bbox</span><span class="o">.</span><span class="n">west</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">east</span>
        <span class="ow">and</span> <span class="n">query_bbox</span><span class="o">.</span><span class="n">east</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">west</span>
        <span class="ow">and</span> <span class="n">query_bbox</span><span class="o">.</span><span class="n">south</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">north</span>
        <span class="ow">and</span> <span class="n">query_bbox</span><span class="o">.</span><span class="n">north</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">south</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.BBox.is_global" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_global</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.BBox.is_global" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Checks if the bounding box is global.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the bounding box is global, False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_global</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the bounding box is global.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the bounding box is global, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">west</span> <span class="o">==</span> <span class="o">-</span><span class="mi">180</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">south</span> <span class="o">==</span> <span class="o">-</span><span class="mi">90</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">east</span> <span class="o">==</span> <span class="mi">180</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">north</span> <span class="o">==</span> <span class="mi">90</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.BBox.to_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.BBox.to_list" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Converts the BBox to a list of four numbers [west, south, east, north].</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[float]</code></td>
      <td><p>List of four numbers representing the bounding box.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts the BBox to a list of four numbers [west, south, east, north].</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[float]: List of four numbers representing the bounding box.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">west</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">south</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">east</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">north</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="geemap.ai.Catalog" class="doc doc-heading">
        <code>
Catalog        </code>



<a href="#geemap.ai.Catalog" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Class containing all collections in the EE STAC catalog.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Catalog</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class containing all collections in the EE STAC catalog.&quot;&quot;&quot;</span>

    <span class="n">collections</span><span class="p">:</span> <span class="n">CollectionList</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the Catalog with collections loaded from Google Cloud Storage.</span>

<span class="sd">        Args:</span>
<span class="sd">            storage_client (storage.Client): The Google Cloud Storage client.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collections</span> <span class="o">=</span> <span class="n">CollectionList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_load_collections</span><span class="p">(</span><span class="n">storage_client</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">get_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Collection</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the collection with the given id.</span>

<span class="sd">        Args:</span>
<span class="sd">            id (str): The ID of the collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Collection: The collection with the given ID.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If no collection with the given ID is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">filter_by_ids</span><span class="p">([</span><span class="nb">id</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No collection with id </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@tenacity</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span>
        <span class="n">stop</span><span class="o">=</span><span class="n">tenacity</span><span class="o">.</span><span class="n">stop_after_attempt</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
        <span class="n">wait</span><span class="o">=</span><span class="n">tenacity</span><span class="o">.</span><span class="n">wait_exponential</span><span class="p">(</span><span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
        <span class="n">retry</span><span class="o">=</span><span class="n">tenacity</span><span class="o">.</span><span class="n">retry_if_exception_type</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">google_exceptions</span><span class="o">.</span><span class="n">GoogleAPICallError</span><span class="p">,</span>
                <span class="n">google_exceptions</span><span class="o">.</span><span class="n">RetryError</span><span class="p">,</span>
                <span class="ne">ConnectionError</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">),</span>
        <span class="n">before_sleep</span><span class="o">=</span><span class="k">lambda</span> <span class="n">retry_state</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Error occurred: </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">retry_state</span><span class="o">.</span><span class="n">outcome</span><span class="o">.</span><span class="n">exception</span><span class="p">())</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Retrying in </span><span class="si">{</span><span class="n">retry_state</span><span class="o">.</span><span class="n">next_action</span><span class="o">.</span><span class="n">sleep</span><span class="si">}</span><span class="s2"> seconds... &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(Attempt </span><span class="si">{</span><span class="n">retry_state</span><span class="o">.</span><span class="n">attempt_number</span><span class="si">}</span><span class="s2">/3)&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">_read_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_blob</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Blob</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Collection</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reads the contents of a file from the specified bucket.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_blob (storage.Blob): The blob representing the file.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Collection: The collection created from the file contents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file_contents</span> <span class="o">=</span> <span class="n">file_blob</span><span class="o">.</span><span class="n">download_as_string</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">Collection</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file_contents</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_read_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_blobs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">storage</span><span class="o">.</span><span class="n">Blob</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Collection</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Processes files in parallel.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_blobs (List[storage.Blob]): The list of file blobs.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Collection]: The list of collections created from the file contents.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">collections</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
            <span class="n">file_futures</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">executor</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_read_file</span><span class="p">,</span> <span class="n">file_blob</span><span class="p">)</span> <span class="k">for</span> <span class="n">file_blob</span> <span class="ow">in</span> <span class="n">file_blobs</span>
            <span class="p">]</span>
            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">file_futures</span><span class="p">:</span>
                <span class="n">collections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">collections</span>

    <span class="k">def</span> <span class="nf">_load_collections</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Collection</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads all EE STAC JSON files from GCS, with datetimes as objects.</span>

<span class="sd">        Args:</span>
<span class="sd">            storage_client (storage.Client): The Google Cloud Storage client.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Sequence[Collection]: A tuple of collections loaded from the files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">bucket</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">get_bucket</span><span class="p">(</span><span class="s2">&quot;earthengine-stac&quot;</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">x</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">bucket</span><span class="o">.</span><span class="n">list_blobs</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;catalog/&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/catalog.json&quot;</span><span class="p">)</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;/units.json&quot;</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Found </span><span class="si">%d</span><span class="s2"> files, loading...&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">))</span>
        <span class="n">collections</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_files</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

        <span class="n">code_samples_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_all_code_samples</span><span class="p">(</span><span class="n">storage_client</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">collections</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">is_deprecated</span><span class="p">():</span>
                <span class="k">continue</span>
            <span class="n">c</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code_samples_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">hyphen_id</span><span class="p">())</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Loaded </span><span class="si">%d</span><span class="s2"> collections (skipping deprecated ones)&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>
        <span class="c1"># Returning a tuple for immutability.</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_load_all_code_samples</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">storage_client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads js + py example scripts from GCS into dict keyed by dataset ID.</span>

<span class="sd">        Args:</span>
<span class="sd">            storage_client (storage.Client): The Google Cloud Storage client.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, Dict[str, str]]: A dictionary mapping dataset IDs to their code samples.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Get json file from GCS bucket</span>
        <span class="c1"># &#39;gs://earthengine-catalog/catalog/example_scripts.json&#39;</span>
        <span class="n">bucket</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">get_bucket</span><span class="p">(</span><span class="s2">&quot;earthengine-catalog&quot;</span><span class="p">)</span>
        <span class="n">blob</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="s2">&quot;catalog/example_scripts.json&quot;</span><span class="p">)</span>
        <span class="n">file_contents</span> <span class="o">=</span> <span class="n">blob</span><span class="o">.</span><span class="n">download_as_string</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">file_contents</span><span class="p">)</span>

        <span class="c1"># Flatten json to get a map from ID (using &#39;_&#39; rather than &#39;/&#39;) to code</span>
        <span class="c1"># sample.</span>
        <span class="n">all_datasets_by_provider</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;contents&quot;</span><span class="p">]</span>
        <span class="n">code_samples_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">provider</span> <span class="ow">in</span> <span class="n">all_datasets_by_provider</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">provider</span><span class="p">[</span><span class="s2">&quot;contents&quot;</span><span class="p">]:</span>
                <span class="n">js_code</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span>
                <span class="n">py_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_python_code_sample</span><span class="p">(</span><span class="n">js_code</span><span class="p">)</span>

                <span class="n">code_samples_dict</span><span class="p">[</span><span class="n">dataset</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;js_code&quot;</span><span class="p">:</span> <span class="n">js_code</span><span class="p">,</span>
                    <span class="s2">&quot;py_code&quot;</span><span class="p">:</span> <span class="n">py_code</span><span class="p">,</span>
                <span class="p">}</span>

        <span class="k">return</span> <span class="n">code_samples_dict</span>

    <span class="k">def</span> <span class="nf">_make_python_code_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">js_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts EE JS code into python.</span>

<span class="sd">        Args:</span>
<span class="sd">            js_code (str): The JavaScript code to convert.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The converted Python code.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># geemap appears to have some stray print statements.</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">redirect_stdout</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
            <span class="n">code_list</span> <span class="o">=</span> <span class="n">js_snippet_to_py</span><span class="p">(</span>
                <span class="n">js_code</span><span class="p">,</span>
                <span class="n">add_new_cell</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">import_ee</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">import_geemap</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">show_map</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">code_list</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Catalog.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_client</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#geemap.ai.Catalog.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Initializes the Catalog with collections loaded from Google Cloud Storage.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>storage_client</code></td>
        <td><code>storage.Client</code></td>
        <td><p>The Google Cloud Storage client.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">storage_client</span><span class="p">:</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the Catalog with collections loaded from Google Cloud Storage.</span>

<span class="sd">    Args:</span>
<span class="sd">        storage_client (storage.Client): The Google Cloud Storage client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">collections</span> <span class="o">=</span> <span class="n">CollectionList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_load_collections</span><span class="p">(</span><span class="n">storage_client</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Catalog.get_collection" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span></code>


<a href="#geemap.ai.Catalog.get_collection" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns the collection with the given id.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>id</code></td>
        <td><code>str</code></td>
        <td><p>The ID of the collection.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Collection</code></td>
      <td><p>The collection with the given ID.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If no collection with the given ID is found.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_collection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Collection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the collection with the given id.</span>

<span class="sd">    Args:</span>
<span class="sd">        id (str): The ID of the collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Collection: The collection with the given ID.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If no collection with the given ID is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">col</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">filter_by_ids</span><span class="p">([</span><span class="nb">id</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No collection with id </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">col</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-class">



<h2 id="geemap.ai.Collection" class="doc doc-heading">
        <code>
Collection        </code>



<a href="#geemap.ai.Collection" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>A simple wrapper for a STAC Collection..</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Collection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A simple wrapper for a STAC Collection..&quot;&quot;&quot;</span>

    <span class="n">stac_json</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stac_json</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the Collection.</span>

<span class="sd">        Args:</span>
<span class="sd">            stac_json (Dict[str, Any]): The STAC JSON of the collection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span> <span class="o">=</span> <span class="n">stac_json</span>
        <span class="k">if</span> <span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gee:status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;deprecated&quot;</span><span class="p">:</span>
            <span class="c1"># Set the STAC &#39;deprecated&#39; field that we don&#39;t set in the jsonnet files</span>
            <span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;deprecated&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets an item from the STAC JSON.</span>

<span class="sd">        Args:</span>
<span class="sd">            item (str): The key of the item to get.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any: The value of the item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Matches dict&#39;s get by returning None if there is no item.</span>

<span class="sd">        Args:</span>
<span class="sd">            item (str): The key of the item to get.</span>
<span class="sd">            default (Optional[Any]): The default value to return if the item is not found. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optional[Any]: The value of the item or the default value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">public_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the public ID of the collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The public ID of the collection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">hyphen_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the hyphenated ID of the collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The hyphenated ID of the collection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_dataset_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the dataset type of the collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The dataset type of the collection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;gee:type&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">is_deprecated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Checks if the collection is deprecated or has a successor.</span>

<span class="sd">        Returns:</span>
<span class="sd">            bool: True if the collection is deprecated or has a successor, False otherwise.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;deprecated&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Skipping deprecated collection: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">public_id</span><span class="p">())</span>
            <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">datetime_interval</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns datetime objects representing temporal extents.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Iterable[Tuple[datetime.datetime, Optional[datetime.datetime]]]:</span>
<span class="sd">                An iterable of tuples representing temporal extents.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the temporal interval start is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">stac_interval</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;extent&quot;</span><span class="p">][</span><span class="s2">&quot;temporal&quot;</span><span class="p">][</span><span class="s2">&quot;interval&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">stac_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Expected a non-empty temporal interval start for &quot;</span>
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">public_id</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="n">start_date</span> <span class="o">=</span> <span class="n">iso8601</span><span class="o">.</span><span class="n">parse_date</span><span class="p">(</span><span class="n">stac_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">stac_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">end_date</span> <span class="o">=</span> <span class="n">iso8601</span><span class="o">.</span><span class="n">parse_date</span><span class="p">(</span><span class="n">stac_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">end_date</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the start datetime of the collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            datetime.datetime: The start datetime of the collection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datetime_interval</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">start_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the start datetime of the collection as a string.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The start datetime of the collection as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">():</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the end datetime of the collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Optional[datetime.datetime]: The end datetime of the collection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datetime_interval</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">end_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the end datetime of the collection as a string.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The end datetime of the collection as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">():</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bbox_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BBox</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the bounding boxes of the collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Sequence[BBox]: A sequence of bounding boxes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;extent&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">:</span>
            <span class="c1"># Assume global if nothing listed.</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">BBox</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">),)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="p">[</span><span class="n">BBox</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;extent&quot;</span><span class="p">][</span><span class="s2">&quot;spatial&quot;</span><span class="p">][</span><span class="s2">&quot;bbox&quot;</span><span class="p">]]</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">bands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the bands of the collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[Dict[str, Any]]: A list of dictionaries representing the bands.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">summaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;summaries&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">summaries</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">summaries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;eo:bands&quot;</span><span class="p">,</span> <span class="p">[])</span>

    <span class="k">def</span> <span class="nf">spatial_resolution_m</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the spatial resolution of the collection in meters.</span>

<span class="sd">        Returns:</span>
<span class="sd">            float: The spatial resolution of the collection in meters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">summaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;summaries&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">summaries</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">if</span> <span class="n">summaries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gsd&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">summaries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gsd&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Fallback for cases where the stac does not follow convention.</span>
        <span class="n">gsd_lst</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&quot;gsd&quot;: (\d+)&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gsd_lst</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">gsd_lst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">temporal_resolution_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the temporal resolution of the collection as a string.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The temporal resolution of the collection as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">interval_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gee:interval&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">interval_dict</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interval_dict</span><span class="p">[</span><span class="s1">&#39;interval&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">interval_dict</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="nf">python_code</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the Python code sample for the collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The Python code sample for the collection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>

        <span class="k">return</span> <span class="n">code</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;py_code&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_python_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the Python code sample for the collection.</span>

<span class="sd">        Args:</span>
<span class="sd">            code (str): The Python code sample to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;js_code&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;py_code&quot;</span><span class="p">:</span> <span class="n">code</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">][</span><span class="s2">&quot;py_code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span>

    <span class="k">def</span> <span class="nf">set_js_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sets the JavaScript code sample for the collection.</span>

<span class="sd">        Args:</span>
<span class="sd">            code (str): The JavaScript code sample to set.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="n">js_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;js_code&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;js_code&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;py_code&quot;</span><span class="p">:</span> <span class="n">code</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">image_preview_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the URL of the preview image for the collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The URL of the preview image for the collection.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If no preview image is found.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="s2">&quot;rel&quot;</span> <span class="ow">in</span> <span class="n">link</span>
                <span class="ow">and</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;rel&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;preview&quot;</span>
                <span class="ow">and</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;image/png&quot;</span>
            <span class="p">):</span>
                <span class="k">return</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No preview image found for </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">catalog_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets the URL of the catalog for the collection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The URL of the catalog for the collection.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">links</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;rel&quot;</span> <span class="ow">in</span> <span class="n">link</span> <span class="ow">and</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;rel&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;catalog&quot;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>

            <span class="c1"># Ideally there would be a &#39;catalog&#39; link but sometimes there isn&#39;t.</span>
            <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://developers.google.com/earth-engine/datasets/catalog/&quot;</span>
            <span class="k">if</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">base_url</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No catalog link found for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">public_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.__getitem__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#geemap.ai.Collection.__getitem__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets an item from the STAC JSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>item</code></td>
        <td><code>str</code></td>
        <td><p>The key of the item to get.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Any</code></td>
      <td><p>The value of the item.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets an item from the STAC JSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        item (str): The key of the item to get.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: The value of the item.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stac_json</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#geemap.ai.Collection.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Initializes the Collection.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>stac_json</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>The STAC JSON of the collection.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stac_json</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the Collection.</span>

<span class="sd">    Args:</span>
<span class="sd">        stac_json (Dict[str, Any]): The STAC JSON of the collection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span> <span class="o">=</span> <span class="n">stac_json</span>
    <span class="k">if</span> <span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gee:status&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;deprecated&quot;</span><span class="p">:</span>
        <span class="c1"># Set the STAC &#39;deprecated&#39; field that we don&#39;t set in the jsonnet files</span>
        <span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;deprecated&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.bands" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.bands" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the bands of the collection.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[Dict[str, Any]]</code></td>
      <td><p>A list of dictionaries representing the bands.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">bands</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the bands of the collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[Dict[str, Any]]: A list of dictionaries representing the bands.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">summaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;summaries&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">summaries</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">return</span> <span class="n">summaries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;eo:bands&quot;</span><span class="p">,</span> <span class="p">[])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.bbox_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">bbox_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.bbox_list" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the bounding boxes of the collection.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Sequence[BBox]</code></td>
      <td><p>A sequence of bounding boxes.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">bbox_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">BBox</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the bounding boxes of the collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Sequence[BBox]: A sequence of bounding boxes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;extent&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">:</span>
        <span class="c1"># Assume global if nothing listed.</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">BBox</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">),)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
        <span class="p">[</span><span class="n">BBox</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;extent&quot;</span><span class="p">][</span><span class="s2">&quot;spatial&quot;</span><span class="p">][</span><span class="s2">&quot;bbox&quot;</span><span class="p">]]</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.catalog_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">catalog_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.catalog_url" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the URL of the catalog for the collection.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The URL of the catalog for the collection.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">catalog_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the URL of the catalog for the collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The URL of the catalog for the collection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">links</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span><span class="p">:</span>
        <span class="k">if</span> <span class="s2">&quot;rel&quot;</span> <span class="ow">in</span> <span class="n">link</span> <span class="ow">and</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;rel&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;catalog&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>

        <span class="c1"># Ideally there would be a &#39;catalog&#39; link but sometimes there isn&#39;t.</span>
        <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://developers.google.com/earth-engine/datasets/catalog/&quot;</span>
        <span class="k">if</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">base_url</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No catalog link found for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">public_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.datetime_interval" class="doc doc-heading">
<code class="highlight language-python"><span class="n">datetime_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.datetime_interval" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns datetime objects representing temporal extents.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Iterable[Tuple[datetime.datetime, Optional[datetime.datetime]]]</code></td>
      <td><p>An iterable of tuples representing temporal extents.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the temporal interval start is not found.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">datetime_interval</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns datetime objects representing temporal extents.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Iterable[Tuple[datetime.datetime, Optional[datetime.datetime]]]:</span>
<span class="sd">            An iterable of tuples representing temporal extents.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the temporal interval start is not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">stac_interval</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;extent&quot;</span><span class="p">][</span><span class="s2">&quot;temporal&quot;</span><span class="p">][</span><span class="s2">&quot;interval&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">stac_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Expected a non-empty temporal interval start for &quot;</span>
                <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">public_id</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="n">iso8601</span><span class="o">.</span><span class="n">parse_date</span><span class="p">(</span><span class="n">stac_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">stac_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">iso8601</span><span class="o">.</span><span class="n">parse_date</span><span class="p">(</span><span class="n">stac_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">yield</span> <span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.end" class="doc doc-heading">
<code class="highlight language-python"><span class="n">end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.end" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the end datetime of the collection.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[datetime.datetime]</code></td>
      <td><p>The end datetime of the collection.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the end datetime of the collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[datetime.datetime]: The end datetime of the collection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datetime_interval</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.end_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">end_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.end_str" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the end datetime of the collection as a string.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The end datetime of the collection as a string.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">end_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the end datetime of the collection as a string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The end datetime of the collection as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">():</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.get" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.get" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Matches dict's get by returning None if there is no item.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>item</code></td>
        <td><code>str</code></td>
        <td><p>The key of the item to get.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>default</code></td>
        <td><code>Optional[Any]</code></td>
        <td><p>The default value to return if the item is not found. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>Optional[Any]</code></td>
      <td><p>The value of the item or the default value.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Matches dict&#39;s get by returning None if there is no item.</span>

<span class="sd">    Args:</span>
<span class="sd">        item (str): The key of the item to get.</span>
<span class="sd">        default (Optional[Any]): The default value to return if the item is not found. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Optional[Any]: The value of the item or the default value.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">default</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.get_dataset_type" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_dataset_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.get_dataset_type" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the dataset type of the collection.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The dataset type of the collection.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_dataset_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the dataset type of the collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The dataset type of the collection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;gee:type&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.hyphen_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">hyphen_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.hyphen_id" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the hyphenated ID of the collection.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The hyphenated ID of the collection.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">hyphen_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the hyphenated ID of the collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The hyphenated ID of the collection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.image_preview_url" class="doc doc-heading">
<code class="highlight language-python"><span class="n">image_preview_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.image_preview_url" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the URL of the preview image for the collection.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The URL of the preview image for the collection.</p></td>
    </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If no preview image is found.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">image_preview_url</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the URL of the preview image for the collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The URL of the preview image for the collection.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If no preview image is found.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;links&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="s2">&quot;rel&quot;</span> <span class="ow">in</span> <span class="n">link</span>
            <span class="ow">and</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;rel&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;preview&quot;</span>
            <span class="ow">and</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;image/png&quot;</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="n">link</span><span class="p">[</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No preview image found for </span><span class="si">{</span><span class="nb">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.is_deprecated" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_deprecated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.is_deprecated" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Checks if the collection is deprecated or has a successor.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the collection is deprecated or has a successor, False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">is_deprecated</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the collection is deprecated or has a successor.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the collection is deprecated or has a successor, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;deprecated&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Skipping deprecated collection: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">public_id</span><span class="p">())</span>
        <span class="k">return</span> <span class="kc">True</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.public_id" class="doc doc-heading">
<code class="highlight language-python"><span class="n">public_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.public_id" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the public ID of the collection.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The public ID of the collection.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">public_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the public ID of the collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The public ID of the collection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.python_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">python_code</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.python_code" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the Python code sample for the collection.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The Python code sample for the collection.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">python_code</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the Python code sample for the collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The Python code sample for the collection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">return</span> <span class="n">code</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;py_code&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.set_js_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_js_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.set_js_code" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Sets the JavaScript code sample for the collection.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>code</code></td>
        <td><code>str</code></td>
        <td><p>The JavaScript code sample to set.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">set_js_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the JavaScript code sample for the collection.</span>

<span class="sd">    Args:</span>
<span class="sd">        code (str): The JavaScript code sample to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="n">js_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;js_code&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;js_code&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;py_code&quot;</span><span class="p">:</span> <span class="n">code</span><span class="p">}</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.set_python_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">set_python_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.set_python_code" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Sets the Python code sample for the collection.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>code</code></td>
        <td><code>str</code></td>
        <td><p>The Python code sample to set.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">set_python_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sets the Python code sample for the collection.</span>

<span class="sd">    Args:</span>
<span class="sd">        code (str): The Python code sample to set.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">code</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;js_code&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;py_code&quot;</span><span class="p">:</span> <span class="n">code</span><span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">][</span><span class="s2">&quot;py_code&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.spatial_resolution_m" class="doc doc-heading">
<code class="highlight language-python"><span class="n">spatial_resolution_m</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.spatial_resolution_m" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the spatial resolution of the collection in meters.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>float</code></td>
      <td><p>The spatial resolution of the collection in meters.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">spatial_resolution_m</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the spatial resolution of the collection in meters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        float: The spatial resolution of the collection in meters.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">summaries</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;summaries&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">summaries</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">summaries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gsd&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">summaries</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gsd&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Fallback for cases where the stac does not follow convention.</span>
    <span class="n">gsd_lst</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;&quot;gsd&quot;: (\d+)&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">gsd_lst</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">gsd_lst</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.start" class="doc doc-heading">
<code class="highlight language-python"><span class="n">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.start" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the start datetime of the collection.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>datetime.datetime</code></td>
      <td><p>The start datetime of the collection.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the start datetime of the collection.</span>

<span class="sd">    Returns:</span>
<span class="sd">        datetime.datetime: The start datetime of the collection.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">datetime_interval</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.start_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">start_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.start_str" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the start datetime of the collection as a string.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The start datetime of the collection as a string.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">start_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the start datetime of the collection as a string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The start datetime of the collection as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">():</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.Collection.temporal_resolution_str" class="doc doc-heading">
<code class="highlight language-python"><span class="n">temporal_resolution_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.Collection.temporal_resolution_str" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Gets the temporal resolution of the collection as a string.</p>

<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The temporal resolution of the collection as a string.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">temporal_resolution_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gets the temporal resolution of the collection as a string.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The temporal resolution of the collection as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">interval_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stac_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;gee:interval&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">interval_dict</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">interval_dict</span><span class="p">[</span><span class="s1">&#39;interval&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">interval_dict</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="geemap.ai.CollectionList" class="doc doc-heading">
        <code>
CollectionList            (<span title="collections.abc.Sequence">Sequence</span>, <span title="typing.Generic">Generic</span>)
        </code>



<a href="#geemap.ai.CollectionList" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>List of stac.Collections; can be filtered to return a smaller sublist.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">CollectionList</span><span class="p">(</span><span class="n">Sequence</span><span class="p">[</span><span class="n">Collection</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;List of stac.Collections; can be filtered to return a smaller sublist.&quot;&quot;&quot;</span>

    <span class="n">_collections</span> <span class="o">=</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Collection</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collections</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Collection</span><span class="p">]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">collections</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">CollectionList</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_collections</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filter_by_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a sublist with only the collections matching the given ids.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">public_id</span><span class="p">()</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">filter_by_datetime</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query_datetime</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a sublist with the time interval matching the given time.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">datetime_interval</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">datetime_interval</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">matches_datetime</span><span class="p">(</span><span class="n">datetime_interval</span><span class="p">,</span> <span class="n">query_datetime</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filter_by_interval</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query_interval</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">],</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a sublist with the time interval matching the given interval.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">datetime_interval</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">datetime_interval</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">matches_interval</span><span class="p">(</span><span class="n">datetime_interval</span><span class="p">,</span> <span class="n">query_interval</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filter_by_bounding_box_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_bbox</span><span class="p">:</span> <span class="n">BBox</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a sublist with the bbox matching the given bbox.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">collection_bbox</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">bbox_list</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">collection_bbox</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">query_bbox</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filter_by_bounding_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_bbox</span><span class="p">:</span> <span class="n">BBox</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a sublist with the bbox matching the given bbox.&quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">collection_bbox</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">bbox_list</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">collection_bbox</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">query_bbox</span><span class="p">):</span>
                    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">start_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sort_by_spatial_resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sorts the collections based on their spatial resolution.</span>
<span class="sd">        Collections with spatial_resolution_m() == -1 are pushed to the end.</span>

<span class="sd">        Args:</span>
<span class="sd">            reverse (bool): If True, sort in descending order (highest resolution first).</span>
<span class="sd">                            If False (default), sort in ascending order (lowest resolution first).</span>

<span class="sd">        Returns:</span>
<span class="sd">            CollectionList: A new CollectionList instance with sorted collections.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">sort_key</span><span class="p">(</span><span class="n">collection</span><span class="p">):</span>
            <span class="n">resolution</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">spatial_resolution_m</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">resolution</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">reverse</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-inf&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">resolution</span>

        <span class="n">sorted_collections</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">sort_key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">sorted_collections</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a new CollectionList containing the first n entries.</span>

<span class="sd">        Args:</span>
<span class="sd">            n (int): The number of entries to include in the new list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            CollectionList: A new CollectionList instance with at most n collections.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Converts a collection list to a dataframe with a select set of fields.&quot;&quot;&quot;</span>

        <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">:</span>
            <span class="c1"># Remove text in parens in dataset name.</span>
            <span class="n">short_title</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\([^)]*\)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

            <span class="n">row</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">public_id</span><span class="p">(),</span>
                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">short_title</span><span class="p">,</span>
                <span class="s2">&quot;temp_res&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">temporal_resolution_str</span><span class="p">(),</span>
                <span class="s2">&quot;spatial_res_m&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">spatial_resolution_m</span><span class="p">(),</span>
                <span class="s2">&quot;earliest&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">start_str</span><span class="p">(),</span>
                <span class="s2">&quot;latest&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">end_str</span><span class="p">(),</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">catalog_url</span><span class="p">(),</span>
            <span class="p">}</span>
            <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">















  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.CollectionList.filter_by_bounding_box" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_by_bounding_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_bbox</span><span class="p">)</span></code>


<a href="#geemap.ai.CollectionList.filter_by_bounding_box" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns a sublist with the bbox matching the given bbox.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">filter_by_bounding_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_bbox</span><span class="p">:</span> <span class="n">BBox</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a sublist with the bbox matching the given bbox.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">collection_bbox</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">bbox_list</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">collection_bbox</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">query_bbox</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.CollectionList.filter_by_bounding_box_list" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_by_bounding_box_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_bbox</span><span class="p">)</span></code>


<a href="#geemap.ai.CollectionList.filter_by_bounding_box_list" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns a sublist with the bbox matching the given bbox.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">filter_by_bounding_box_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_bbox</span><span class="p">:</span> <span class="n">BBox</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a sublist with the bbox matching the given bbox.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">collection_bbox</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">bbox_list</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">collection_bbox</span><span class="o">.</span><span class="n">intersects</span><span class="p">(</span><span class="n">query_bbox</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.CollectionList.filter_by_datetime" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_by_datetime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_datetime</span><span class="p">)</span></code>


<a href="#geemap.ai.CollectionList.filter_by_datetime" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns a sublist with the time interval matching the given time.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">filter_by_datetime</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">query_datetime</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a sublist with the time interval matching the given time.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">datetime_interval</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">datetime_interval</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">matches_datetime</span><span class="p">(</span><span class="n">datetime_interval</span><span class="p">,</span> <span class="n">query_datetime</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.CollectionList.filter_by_ids" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_by_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">)</span></code>


<a href="#geemap.ai.CollectionList.filter_by_ids" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns a sublist with only the collections matching the given ids.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">filter_by_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a sublist with only the collections matching the given ids.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">([</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">public_id</span><span class="p">()</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.CollectionList.filter_by_interval" class="doc doc-heading">
<code class="highlight language-python"><span class="n">filter_by_interval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query_interval</span><span class="p">)</span></code>


<a href="#geemap.ai.CollectionList.filter_by_interval" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns a sublist with the time interval matching the given interval.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">filter_by_interval</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">query_interval</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">],</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns a sublist with the time interval matching the given interval.&quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">collection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">datetime_interval</span> <span class="ow">in</span> <span class="n">collection</span><span class="o">.</span><span class="n">datetime_interval</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">matches_interval</span><span class="p">(</span><span class="n">datetime_interval</span><span class="p">,</span> <span class="n">query_interval</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.CollectionList.limit" class="doc doc-heading">
<code class="highlight language-python"><span class="n">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>


<a href="#geemap.ai.CollectionList.limit" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Returns a new CollectionList containing the first n entries.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>n</code></td>
        <td><code>int</code></td>
        <td><p>The number of entries to include in the new list.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>CollectionList</code></td>
      <td><p>A new CollectionList instance with at most n collections.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a new CollectionList containing the first n entries.</span>

<span class="sd">    Args:</span>
<span class="sd">        n (int): The number of entries to include in the new list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        CollectionList: A new CollectionList instance with at most n collections.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.CollectionList.sort_by_spatial_resolution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">sort_by_spatial_resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#geemap.ai.CollectionList.sort_by_spatial_resolution" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Sorts the collections based on their spatial resolution.
Collections with spatial_resolution_m() == -1 are pushed to the end.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>reverse</code></td>
        <td><code>bool</code></td>
        <td><p>If True, sort in descending order (highest resolution first).
            If False (default), sort in ascending order (lowest resolution first).</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>CollectionList</code></td>
      <td><p>A new CollectionList instance with sorted collections.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">sort_by_spatial_resolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sorts the collections based on their spatial resolution.</span>
<span class="sd">    Collections with spatial_resolution_m() == -1 are pushed to the end.</span>

<span class="sd">    Args:</span>
<span class="sd">        reverse (bool): If True, sort in descending order (highest resolution first).</span>
<span class="sd">                        If False (default), sort in ascending order (lowest resolution first).</span>

<span class="sd">    Returns:</span>
<span class="sd">        CollectionList: A new CollectionList instance with sorted collections.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">sort_key</span><span class="p">(</span><span class="n">collection</span><span class="p">):</span>
        <span class="n">resolution</span> <span class="o">=</span> <span class="n">collection</span><span class="o">.</span><span class="n">spatial_resolution_m</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">resolution</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">reverse</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;-inf&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">resolution</span>

    <span class="n">sorted_collections</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">sort_key</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">sorted_collections</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.CollectionList.to_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.CollectionList.to_df" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Converts a collection list to a dataframe with a select set of fields.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">to_df</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts a collection list to a dataframe with a select set of fields.&quot;&quot;&quot;</span>

    <span class="n">rows</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_collections</span><span class="p">:</span>
        <span class="c1"># Remove text in parens in dataset name.</span>
        <span class="n">short_title</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\([^)]*\)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="n">row</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">public_id</span><span class="p">(),</span>
            <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">short_title</span><span class="p">,</span>
            <span class="s2">&quot;temp_res&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">temporal_resolution_str</span><span class="p">(),</span>
            <span class="s2">&quot;spatial_res_m&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">spatial_resolution_m</span><span class="p">(),</span>
            <span class="s2">&quot;earliest&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">start_str</span><span class="p">(),</span>
            <span class="s2">&quot;latest&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">end_str</span><span class="p">(),</span>
            <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">catalog_url</span><span class="p">(),</span>
        <span class="p">}</span>
        <span class="n">rows</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="geemap.ai.DatasetExplorer" class="doc doc-heading">
        <code>
DatasetExplorer        </code>



<a href="#geemap.ai.DatasetExplorer" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>A widget for exploring Earth Engine datasets.
The DataExplorer class source code is adapted from <a href="https://bit.ly/48cE24D">https://bit.ly/48cE24D</a>.
Credit to the original author Renee Johnston (<a href="https://github.com/raj02006">https://github.com/raj02006</a>)</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">DatasetExplorer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A widget for exploring Earth Engine datasets.</span>
<span class="sd">    The DataExplorer class source code is adapted from &lt;https://bit.ly/48cE24D&gt;.</span>
<span class="sd">    Credit to the original author Renee Johnston (&lt;https://github.com/raj02006&gt;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">project_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GOOGLE_PROJECT_ID&quot;</span><span class="p">,</span>
        <span class="n">google_api_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GOOGLE_API_KEY&quot;</span><span class="p">,</span>
        <span class="n">vertex_ai_zone</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;us-central1&quot;</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gemini-1.5-pro&quot;</span><span class="p">,</span>
        <span class="n">embeddings_cloud_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gs://earthengine-catalog/embeddings/catalog_embeddings.jsonl&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the DatasetExplorer.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_id (str): Google Cloud project ID. Defaults to &quot;GOOGLE_PROJECT_ID&quot;.</span>
<span class="sd">            google_api_key (str): Google API key. Defaults to &quot;GOOGLE_API_KEY&quot;.</span>
<span class="sd">            vertex_ai_zone (str): Vertex AI zone. Defaults to &quot;us-central1&quot;.</span>
<span class="sd">            model (str): Model name for ChatGoogleGenerativeAI. Defaults to &quot;gemini-1.5-pro&quot;.</span>
<span class="sd">            embeddings_cloud_path (str): Cloud path to the embeddings file.</span>
<span class="sd">                Defaults to &quot;gs://earthengine-catalog/embeddings/catalog_embeddings.jsonl&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># @title Setup</span>
        <span class="n">project_name</span> <span class="o">=</span> <span class="n">get_env_var</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">project_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">project_name</span> <span class="o">=</span> <span class="n">get_env_var</span><span class="p">(</span><span class="s2">&quot;EE_PROJECT_ID&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">project_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please provide a Google Cloud project ID.&quot;</span><span class="p">)</span>

        <span class="n">genai</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="n">get_env_var</span><span class="p">(</span><span class="n">google_api_key</span><span class="p">))</span>

        <span class="n">ee</span><span class="o">.</span><span class="n">Authenticate</span><span class="p">()</span>
        <span class="n">ee</span><span class="o">.</span><span class="n">Initialize</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_name</span><span class="p">)</span>
        <span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_name</span><span class="p">)</span>
        <span class="n">vertexai</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_name</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">vertex_ai_zone</span><span class="p">)</span>

        <span class="c1"># Make sure geemap initialized correctly.</span>
        <span class="n">ee_initialize</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_name</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span><span class="n">draw_ctrl</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;layer_manager&quot;</span><span class="p">)</span>

        <span class="n">catalog</span> <span class="o">=</span> <span class="n">Catalog</span><span class="p">(</span><span class="n">storage_client</span><span class="p">)</span>

        <span class="c1"># Pre-built embeddings.</span>
        <span class="n">EMBEDDINGS_CLOUD_PATH</span> <span class="o">=</span> <span class="n">embeddings_cloud_path</span>

        <span class="c1"># Copy embeddings from GCS bucket to a local file</span>
        <span class="n">EMBEDDINGS_LOCAL_PATH</span> <span class="o">=</span> <span class="s2">&quot;catalog_embeddings.jsonl&quot;</span>

        <span class="k">def</span> <span class="nf">load_embeddings</span><span class="p">(</span>
            <span class="n">gcs_path</span><span class="o">=</span><span class="n">EMBEDDINGS_CLOUD_PATH</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="n">EMBEDDINGS_LOCAL_PATH</span>
        <span class="p">):</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">gcs_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
            <span class="n">bucket_name</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">blob_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
            <span class="n">bucket</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">get_bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">)</span>
            <span class="n">blob</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="n">blob_path</span><span class="p">)</span>
            <span class="n">blob</span><span class="o">.</span><span class="n">download_to_filename</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">local_path</span>

        <span class="c1"># Load our embeddings data into a dataframe:</span>
        <span class="n">local_path</span> <span class="o">=</span> <span class="n">load_embeddings</span><span class="p">(</span><span class="n">EMBEDDINGS_CLOUD_PATH</span><span class="p">,</span> <span class="n">EMBEDDINGS_LOCAL_PATH</span><span class="p">)</span>
        <span class="n">embeddings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">llm</span> <span class="o">=</span> <span class="n">ChatGoogleGenerativeAI</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">google_api_key</span><span class="o">=</span><span class="n">get_env_var</span><span class="p">(</span><span class="n">google_api_key</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">local_path</span> <span class="o">=</span> <span class="n">load_embeddings</span><span class="p">(</span><span class="n">EMBEDDINGS_CLOUD_PATH</span><span class="p">,</span> <span class="n">EMBEDDINGS_LOCAL_PATH</span><span class="p">)</span>
        <span class="n">embeddings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">langchain_index</span> <span class="o">=</span> <span class="n">make_langchain_index</span><span class="p">(</span><span class="n">embeddings_df</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ee_index</span> <span class="o">=</span> <span class="n">EarthEngineDatasetIndex</span><span class="p">(</span><span class="n">catalog</span><span class="p">,</span> <span class="n">langchain_index</span><span class="p">,</span> <span class="n">llm</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Displays a query interface for searching datasets.</span>

<span class="sd">        Args:</span>
<span class="sd">            query (Optional[str]): The initial query string. Defaults to None.</span>
<span class="sd">            **kwargs (Any): Additional keyword arguments for widget styling.</span>

<span class="sd">        Returns:</span>
<span class="sd">            widgets.VBox: A VBox containing the query input and output display.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">output</span><span class="o">.</span><span class="n">no_vertical_scroll</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;style&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;description_width&quot;</span><span class="p">:</span> <span class="s2">&quot;initial&quot;</span><span class="p">}</span>
        <span class="k">if</span> <span class="s2">&quot;layout&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;98%&quot;</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">Question</span><span class="p">(</span><span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Handles the query and displays the dataset search results.</span>

<span class="sd">            Args:</span>
<span class="sd">                query (str): The query string.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_question</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid question. Please try again.&quot;</span><span class="p">)</span>
                <span class="k">return</span>

            <span class="n">datasets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ee_index</span><span class="o">.</span><span class="n">find_top_matches</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
            <span class="c1"># datasets = datasets.sort_by_spatial_resolution().limit(5)</span>
            <span class="n">datasets</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
            <span class="n">dataset_search</span> <span class="o">=</span> <span class="n">DatasetSearchInterface</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">datasets</span><span class="p">)</span>
            <span class="n">dataset_search</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;How have global land surface temperatures changed over time?&quot;</span>

        <span class="n">query_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span>
            <span class="n">value</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
            <span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;Type your query here and press Enter&quot;</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Query:&quot;</span><span class="p">,</span>
            <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;Type your query here and press Enter&quot;</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">output_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

        <span class="n">display_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">query_widget</span><span class="p">,</span> <span class="n">output_widget</span><span class="p">])</span>

        <span class="k">def</span> <span class="nf">on_query_change</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Handles the event when the query text is submitted.</span>

<span class="sd">            Args:</span>
<span class="sd">                text (widgets.Text): The text widget containing the query.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="n">output_widget</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
            <span class="k">with</span> <span class="n">output_widget</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading ...&quot;</span><span class="p">)</span>
                <span class="n">output_widget</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">Question</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="n">query_widget</span><span class="o">.</span><span class="n">on_submit</span><span class="p">(</span><span class="n">on_query_change</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">display_widget</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.DatasetExplorer.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_id</span><span class="o">=</span><span class="s1">&#39;GOOGLE_PROJECT_ID&#39;</span><span class="p">,</span> <span class="n">google_api_key</span><span class="o">=</span><span class="s1">&#39;GOOGLE_API_KEY&#39;</span><span class="p">,</span> <span class="n">vertex_ai_zone</span><span class="o">=</span><span class="s1">&#39;us-central1&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s1">&#39;gemini-1.5-pro&#39;</span><span class="p">,</span> <span class="n">embeddings_cloud_path</span><span class="o">=</span><span class="s1">&#39;gs://earthengine-catalog/embeddings/catalog_embeddings.jsonl&#39;</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#geemap.ai.DatasetExplorer.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Initializes the DatasetExplorer.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>project_id</code></td>
        <td><code>str</code></td>
        <td><p>Google Cloud project ID. Defaults to "GOOGLE_PROJECT_ID".</p></td>
        <td><code>&#39;GOOGLE_PROJECT_ID&#39;</code></td>
      </tr>
      <tr>
        <td><code>google_api_key</code></td>
        <td><code>str</code></td>
        <td><p>Google API key. Defaults to "GOOGLE_API_KEY".</p></td>
        <td><code>&#39;GOOGLE_API_KEY&#39;</code></td>
      </tr>
      <tr>
        <td><code>vertex_ai_zone</code></td>
        <td><code>str</code></td>
        <td><p>Vertex AI zone. Defaults to "us-central1".</p></td>
        <td><code>&#39;us-central1&#39;</code></td>
      </tr>
      <tr>
        <td><code>model</code></td>
        <td><code>str</code></td>
        <td><p>Model name for ChatGoogleGenerativeAI. Defaults to "gemini-1.5-pro".</p></td>
        <td><code>&#39;gemini-1.5-pro&#39;</code></td>
      </tr>
      <tr>
        <td><code>embeddings_cloud_path</code></td>
        <td><code>str</code></td>
        <td><p>Cloud path to the embeddings file.
Defaults to "gs://earthengine-catalog/embeddings/catalog_embeddings.jsonl".</p></td>
        <td><code>&#39;gs://earthengine-catalog/embeddings/catalog_embeddings.jsonl&#39;</code></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">project_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GOOGLE_PROJECT_ID&quot;</span><span class="p">,</span>
    <span class="n">google_api_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;GOOGLE_API_KEY&quot;</span><span class="p">,</span>
    <span class="n">vertex_ai_zone</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;us-central1&quot;</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gemini-1.5-pro&quot;</span><span class="p">,</span>
    <span class="n">embeddings_cloud_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gs://earthengine-catalog/embeddings/catalog_embeddings.jsonl&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the DatasetExplorer.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_id (str): Google Cloud project ID. Defaults to &quot;GOOGLE_PROJECT_ID&quot;.</span>
<span class="sd">        google_api_key (str): Google API key. Defaults to &quot;GOOGLE_API_KEY&quot;.</span>
<span class="sd">        vertex_ai_zone (str): Vertex AI zone. Defaults to &quot;us-central1&quot;.</span>
<span class="sd">        model (str): Model name for ChatGoogleGenerativeAI. Defaults to &quot;gemini-1.5-pro&quot;.</span>
<span class="sd">        embeddings_cloud_path (str): Cloud path to the embeddings file.</span>
<span class="sd">            Defaults to &quot;gs://earthengine-catalog/embeddings/catalog_embeddings.jsonl&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># @title Setup</span>
    <span class="n">project_name</span> <span class="o">=</span> <span class="n">get_env_var</span><span class="p">(</span><span class="n">project_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">project_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">project_name</span> <span class="o">=</span> <span class="n">get_env_var</span><span class="p">(</span><span class="s2">&quot;EE_PROJECT_ID&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">project_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please provide a Google Cloud project ID.&quot;</span><span class="p">)</span>

    <span class="n">genai</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="n">get_env_var</span><span class="p">(</span><span class="n">google_api_key</span><span class="p">))</span>

    <span class="n">ee</span><span class="o">.</span><span class="n">Authenticate</span><span class="p">()</span>
    <span class="n">ee</span><span class="o">.</span><span class="n">Initialize</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_name</span><span class="p">)</span>
    <span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_name</span><span class="p">)</span>
    <span class="n">vertexai</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_name</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">vertex_ai_zone</span><span class="p">)</span>

    <span class="c1"># Make sure geemap initialized correctly.</span>
    <span class="n">ee_initialize</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_name</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span><span class="n">draw_ctrl</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;layer_manager&quot;</span><span class="p">)</span>

    <span class="n">catalog</span> <span class="o">=</span> <span class="n">Catalog</span><span class="p">(</span><span class="n">storage_client</span><span class="p">)</span>

    <span class="c1"># Pre-built embeddings.</span>
    <span class="n">EMBEDDINGS_CLOUD_PATH</span> <span class="o">=</span> <span class="n">embeddings_cloud_path</span>

    <span class="c1"># Copy embeddings from GCS bucket to a local file</span>
    <span class="n">EMBEDDINGS_LOCAL_PATH</span> <span class="o">=</span> <span class="s2">&quot;catalog_embeddings.jsonl&quot;</span>

    <span class="k">def</span> <span class="nf">load_embeddings</span><span class="p">(</span>
        <span class="n">gcs_path</span><span class="o">=</span><span class="n">EMBEDDINGS_CLOUD_PATH</span><span class="p">,</span> <span class="n">local_path</span><span class="o">=</span><span class="n">EMBEDDINGS_LOCAL_PATH</span>
    <span class="p">):</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="n">gcs_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="n">bucket_name</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">blob_path</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
        <span class="n">bucket</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">get_bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">)</span>
        <span class="n">blob</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="n">blob_path</span><span class="p">)</span>
        <span class="n">blob</span><span class="o">.</span><span class="n">download_to_filename</span><span class="p">(</span><span class="n">local_path</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">local_path</span>

    <span class="c1"># Load our embeddings data into a dataframe:</span>
    <span class="n">local_path</span> <span class="o">=</span> <span class="n">load_embeddings</span><span class="p">(</span><span class="n">EMBEDDINGS_CLOUD_PATH</span><span class="p">,</span> <span class="n">EMBEDDINGS_LOCAL_PATH</span><span class="p">)</span>
    <span class="n">embeddings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">llm</span> <span class="o">=</span> <span class="n">ChatGoogleGenerativeAI</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">google_api_key</span><span class="o">=</span><span class="n">get_env_var</span><span class="p">(</span><span class="n">google_api_key</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">local_path</span> <span class="o">=</span> <span class="n">load_embeddings</span><span class="p">(</span><span class="n">EMBEDDINGS_CLOUD_PATH</span><span class="p">,</span> <span class="n">EMBEDDINGS_LOCAL_PATH</span><span class="p">)</span>
    <span class="n">embeddings_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="n">local_path</span><span class="p">,</span> <span class="n">lines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">langchain_index</span> <span class="o">=</span> <span class="n">make_langchain_index</span><span class="p">(</span><span class="n">embeddings_df</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">ee_index</span> <span class="o">=</span> <span class="n">EarthEngineDatasetIndex</span><span class="p">(</span><span class="n">catalog</span><span class="p">,</span> <span class="n">langchain_index</span><span class="p">,</span> <span class="n">llm</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.DatasetExplorer.show" class="doc doc-heading">
<code class="highlight language-python"><span class="n">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


<a href="#geemap.ai.DatasetExplorer.show" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Displays a query interface for searching datasets.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>The initial query string. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>**kwargs</code></td>
        <td><code>Any</code></td>
        <td><p>Additional keyword arguments for widget styling.</p></td>
        <td><code>{}</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>widgets.VBox</code></td>
      <td><p>A VBox containing the query input and output display.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays a query interface for searching datasets.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (Optional[str]): The initial query string. Defaults to None.</span>
<span class="sd">        **kwargs (Any): Additional keyword arguments for widget styling.</span>

<span class="sd">    Returns:</span>
<span class="sd">        widgets.VBox: A VBox containing the query input and output display.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">output</span><span class="o">.</span><span class="n">no_vertical_scroll</span><span class="p">()</span>

    <span class="k">if</span> <span class="s2">&quot;style&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;description_width&quot;</span><span class="p">:</span> <span class="s2">&quot;initial&quot;</span><span class="p">}</span>
    <span class="k">if</span> <span class="s2">&quot;layout&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;layout&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;98%&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Question</span><span class="p">(</span><span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handles the query and displays the dataset search results.</span>

<span class="sd">        Args:</span>
<span class="sd">            query (str): The query string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_question</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Invalid question. Please try again.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">datasets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ee_index</span><span class="o">.</span><span class="n">find_top_matches</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="c1"># datasets = datasets.sort_by_spatial_resolution().limit(5)</span>
        <span class="n">datasets</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">dataset_search</span> <span class="o">=</span> <span class="n">DatasetSearchInterface</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">datasets</span><span class="p">)</span>
        <span class="n">dataset_search</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">query</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;How have global land surface temperatures changed over time?&quot;</span>

    <span class="n">query_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span>
        <span class="n">value</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
        <span class="n">placeholder</span><span class="o">=</span><span class="s2">&quot;Type your query here and press Enter&quot;</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Query:&quot;</span><span class="p">,</span>
        <span class="n">tooltip</span><span class="o">=</span><span class="s2">&quot;Type your query here and press Enter&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">output_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>

    <span class="n">display_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">query_widget</span><span class="p">,</span> <span class="n">output_widget</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">on_query_change</span><span class="p">(</span><span class="n">text</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handles the event when the query text is submitted.</span>

<span class="sd">        Args:</span>
<span class="sd">            text (widgets.Text): The text widget containing the query.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output_widget</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">output_widget</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading ...&quot;</span><span class="p">)</span>
            <span class="n">output_widget</span><span class="o">.</span><span class="n">clear_output</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">Question</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

    <span class="n">query_widget</span><span class="o">.</span><span class="n">on_submit</span><span class="p">(</span><span class="n">on_query_change</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">display_widget</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="geemap.ai.DatasetSearchInterface" class="doc doc-heading">
        <code>
DatasetSearchInterface        </code>



<a href="#geemap.ai.DatasetSearchInterface" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Interface for searching and displaying Earth Engine datasets.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">DatasetSearchInterface</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Interface for searching and displaying Earth Engine datasets.&quot;&quot;&quot;</span>

    <span class="n">collections</span><span class="p">:</span> <span class="n">CollectionList</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">dataset_table</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Widget</span>
    <span class="n">code_output</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Widget</span>
    <span class="n">details_output</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Widget</span>
    <span class="n">map_output</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Widget</span>
    <span class="n">geemap_instance</span><span class="p">:</span> <span class="n">Map</span>

    <span class="c1"># Parent containers for controlling widget visibility.</span>
    <span class="n">details_code_box</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Widget</span>
    <span class="n">map_widget</span><span class="p">:</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Widget</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">collections</span><span class="p">:</span> <span class="n">CollectionList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the DatasetSearchInterface.</span>

<span class="sd">        Args:</span>
<span class="sd">            query (str): The search query string.</span>
<span class="sd">            collections (CollectionList): The list of dataset collections.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="n">query</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collections</span> <span class="o">=</span> <span class="n">collections</span>

        <span class="c1"># Create the output widgets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;50%&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="s2">&quot;300px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="c1"># Initialize dataset table</span>
        <span class="n">table_html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_table_html</span><span class="p">(</span><span class="n">collections</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataset_table</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">table_html</span><span class="p">)</span>

        <span class="n">_callback_id</span> <span class="o">=</span> <span class="s2">&quot;dataset-select&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
        <span class="n">output</span><span class="o">.</span><span class="n">register_callback</span><span class="p">(</span><span class="n">_callback_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_outputs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_select_js_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_select_js_code</span><span class="p">(</span><span class="n">_callback_id</span><span class="p">)</span>
        <span class="c1"># self._dataset_select_js_code(_callback_id)</span>

        <span class="c1"># Initialize map</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geemap_instance</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="s2">&quot;600px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Display the UI in the cell.&quot;&quot;&quot;</span>
        <span class="c1"># Create title and description with Material Design styling</span>
        <span class="c1"># title = widgets.HTML(value=&#39;&lt;h2 class=&quot;main-title&quot;&gt;Earth Engine Dataset Explorer&lt;/h2&gt;&#39;)</span>

        <span class="c1"># Wrap outputs in a widget box for border styling</span>
        <span class="n">details_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">details_output</span><span class="p">],</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
                <span class="n">border</span><span class="o">=</span><span class="s2">&quot;1px solid #E0E0E0&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10px&quot;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="n">code_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">code_output</span><span class="p">],</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
                <span class="n">border</span><span class="o">=</span><span class="s2">&quot;1px solid #E0E0E0&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10px&quot;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">map_output</span><span class="p">],</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
                <span class="n">border</span><span class="o">=</span><span class="s2">&quot;1px solid #E0E0E0&quot;</span><span class="p">,</span>
                <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10px&quot;</span><span class="p">,</span>
                <span class="n">margin</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span><span class="p">,</span>
                <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span>
                <span class="n">height</span><span class="o">=</span><span class="s2">&quot;600x&quot;</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Create the vertical box for code and details</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details_code_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
            <span class="p">[</span><span class="n">details_widget</span><span class="p">,</span> <span class="n">code_widget</span><span class="p">],</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;50%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;600px&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Create a horizontal box for map and details/code</span>
        <span class="n">map_details_code_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">map_widget</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">details_code_box</span><span class="p">],</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
                <span class="n">border</span><span class="o">=</span><span class="s2">&quot;1px solid #E0E0E0&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10px&quot;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Create the main layout with Material Design styling</span>
        <span class="n">main_content</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_table</span><span class="p">,</span> <span class="n">map_details_code_box</span><span class="p">],</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
                <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;1px solid #E0E0E0&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10px&quot;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span>
            <span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># Add debug panel to the main layout</span>
        <span class="n">main_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="c1"># title,</span>
                <span class="n">main_content</span><span class="p">,</span>
            <span class="p">],</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="s2">&quot;1500px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;24px&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># @title CSS</span>
        <span class="c1"># Custom CSS for Material Design styling with enhanced table styling, chat panel, and debug panel</span>
        <span class="n">CSS</span> <span class="o">=</span> <span class="n">syntax</span><span class="o">.</span><span class="n">css</span><span class="p">(</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        @import url(&#39;https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&amp;display=swap&#39;);</span>

<span class="sd">        body {</span>
<span class="sd">            font-family: &#39;Roboto&#39;, sans-serif;</span>
<span class="sd">            margin: 0;</span>
<span class="sd">            padding: 0;</span>
<span class="sd">        }</span>

<span class="sd">        .main-title {</span>
<span class="sd">            font-size: 24px;</span>
<span class="sd">            font-weight: 500;</span>
<span class="sd">            color: #212121;</span>
<span class="sd">            margin-bottom: 16px;</span>
<span class="sd">        }</span>

<span class="sd">        .custom-title {</span>
<span class="sd">            font-size: 18px;</span>
<span class="sd">            font-weight: 500;</span>
<span class="sd">            color: #212121;</span>
<span class="sd">            margin-bottom: 12px;</span>
<span class="sd">        }</span>

<span class="sd">        .details-text {</span>
<span class="sd">            font-size: 14px;</span>
<span class="sd">            color: #616161;</span>
<span class="sd">            line-height: 1.5;</span>
<span class="sd">        }</span>

<span class="sd">        .custom-table {</span>
<span class="sd">            width: 100%;</span>
<span class="sd">            border-collapse: collapse;</span>
<span class="sd">            margin-bottom: 24px;</span>
<span class="sd">            font-family: &#39;Roboto&#39;, sans-serif;</span>
<span class="sd">        }</span>
<span class="sd">        .custom-table th, .custom-table td {</span>
<span class="sd">            text-align: left;</span>
<span class="sd">            padding: 12px;</span>
<span class="sd">            border-bottom: 1px solid #E0E0E0;</span>
<span class="sd">        }</span>
<span class="sd">        .custom-table th {</span>
<span class="sd">            background-color: #F5F5F5;</span>
<span class="sd">            font-weight: 500;</span>
<span class="sd">            color: #212121;</span>
<span class="sd">        }</span>
<span class="sd">        .custom-table tr:hover {</span>
<span class="sd">            background-color: #E3F2FD;</span>
<span class="sd">        }</span>
<span class="sd">        .custom-table tr.selected {</span>
<span class="sd">            background-color: #BBDEFB;</span>
<span class="sd">        }</span>

<span class="sd">        /* Ensure borders are visible */</span>
<span class="sd">        .jupyter-widgets.widget-box {</span>
<span class="sd">            border: 1px solid #E0E0E0 !important;</span>
<span class="sd">            overflow: auto;</span>
<span class="sd">        }</span>

<span class="sd">        /* Make the map span full width */</span>
<span class="sd">        .geemap-container {</span>
<span class="sd">            width: 100% !important;</span>
<span class="sd">            height: 600px !important;</span>
<span class="sd">        }</span>

<span class="sd">        # Disable table clicks while things are loading</span>
<span class="sd">        .disabled {</span>
<span class="sd">        pointer-events: none;</span>
<span class="sd">        /* You might also want to visually indicate the disabled state */</span>
<span class="sd">        opacity: 0.5;</span>
<span class="sd">        cursor: default;</span>
<span class="sd">        }</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Display the widget</span>
        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;style&gt;</span><span class="si">{</span><span class="n">CSS</span><span class="si">}</span><span class="s2">&lt;/style&gt;&quot;</span><span class="p">))</span>
        <span class="n">display</span><span class="p">(</span><span class="n">main_layout</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">Javascript</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset_select_js_code</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_build_table_html</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collections</span><span class="p">:</span> <span class="n">CollectionList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Builds the HTML for the dataset table.</span>

<span class="sd">        Args:</span>
<span class="sd">            collections (CollectionList): The list of dataset collections.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The HTML string for the dataset table.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">table_html</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;table class=&quot;custom-table&quot;&gt;</span>
<span class="s2">        &lt;tr&gt;</span>
<span class="s2">            &lt;th&gt;Dataset ID&lt;/th&gt;</span>
<span class="s2">            &lt;th&gt; Name &lt;/th&gt;</span>
<span class="s2">            &lt;th&gt;Temporal Resolution&lt;/th&gt;</span>
<span class="s2">            &lt;th&gt;Spatial Resolution (m)&lt;/th&gt;</span>
<span class="s2">            &lt;th&gt;Earliest&lt;/th&gt;</span>
<span class="s2">            &lt;th&gt;Latest&lt;/th&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">collections</span><span class="p">:</span>
            <span class="n">table_html</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        &lt;tr data-dataset=&quot;</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">public_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<span class="s2">            &lt;td&gt;</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">public_id</span><span class="p">()</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">            &lt;td&gt;</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">            &lt;td&gt;</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">temporal_resolution_str</span><span class="p">()</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">            &lt;td&gt;</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">spatial_resolution_m</span><span class="p">()</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">            &lt;td&gt;</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">start_str</span><span class="p">()</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">            &lt;td&gt;</span><span class="si">{</span><span class="n">dataset</span><span class="o">.</span><span class="n">end_str</span><span class="p">()</span><span class="si">}</span><span class="s2">&lt;/td&gt;</span>
<span class="s2">        &lt;/tr&gt;</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="n">table_html</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/table&gt;&quot;</span>
        <span class="k">return</span> <span class="n">table_html</span>

    <span class="k">def</span> <span class="nf">update_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates the output widgets based on the selected dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            selected_dataset (str): The ID of the selected dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">filter_by_ids</span><span class="p">([</span><span class="n">selected_dataset</span><span class="p">])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">collection</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">details_code_box</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">visibility</span> <span class="o">=</span> <span class="s2">&quot;hidden&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map_widget</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">visibility</span> <span class="o">=</span> <span class="s2">&quot;hidden&quot;</span>
            <span class="k">return</span>

        <span class="n">dataset</span> <span class="o">=</span> <span class="n">collection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Clear everything when a new dataset is selected.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
        <span class="c1"># Clear previous layers. Keep only the base layer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geemap_instance</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geemap_instance</span><span class="o">.</span><span class="n">layers</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_output</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;h3&gt;Loading...&lt;/h3&gt;&quot;</span><span class="p">))</span>
            <span class="n">code</span> <span class="o">=</span> <span class="n">fix_ee_python_code</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">python_code</span><span class="p">(),</span> <span class="n">ee</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geemap_instance</span><span class="p">)</span>
            <span class="n">llm_thoughts</span> <span class="o">=</span> <span class="n">explain_relevance_from_stac_json</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">stac_json</span>
            <span class="p">)</span>

        <span class="c1"># Code and LLM thought content is now fully loaded.</span>
        <span class="c1"># We ought to make this asynchronous in another version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_output</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;div class=&quot;custom-title&quot;&gt;Earth Engine Code&lt;/div&gt;&#39;</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">details_output</span><span class="p">:</span>
            <span class="c1"># display(HTML(&#39;&lt;h3&gt;Thinking...&lt;/h3&gt;&#39;))</span>
            <span class="c1"># self.details_output.clear_output()</span>
            <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;div class=&quot;custom-title&quot;&gt;Thoughts with Gemini&lt;/div&gt;&#39;</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">llm_thoughts</span><span class="p">)</span>

        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_output</span><span class="p">:</span>
            <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geemap_instance</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">details_code_box</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">visibility</span> <span class="o">=</span> <span class="s2">&quot;visible&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_widget</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">visibility</span> <span class="o">=</span> <span class="s2">&quot;visible&quot;</span>

    <span class="k">def</span> <span class="nf">_dataset_select_js_code</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generates JavaScript code for handling dataset selection.</span>

<span class="sd">        Args:</span>
<span class="sd">            callback_id (str): The callback ID for the dataset selection.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The JavaScript code as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Template</span><span class="p">(</span>
            <span class="n">syntax</span><span class="o">.</span><span class="n">javascript</span><span class="p">(</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    function initializeTableInteraction() {</span>
<span class="sd">        const table = document.querySelector(&#39;.custom-table&#39;);</span>
<span class="sd">        if (!table) {</span>
<span class="sd">            console.error(&#39;Table not found&#39;);</span>
<span class="sd">            return;</span>
<span class="sd">        }</span>

<span class="sd">        function selectRow(row) {</span>
<span class="sd">            // Remove selection from previously selected row</span>
<span class="sd">            const prevSelected = table.querySelector(&#39;tr.selected&#39;);</span>
<span class="sd">            if (prevSelected) prevSelected.classList.remove(&#39;selected&#39;);</span>

<span class="sd">            // Add selection to the new row</span>
<span class="sd">            row.classList.add(&#39;selected&#39;);</span>
<span class="sd">            const selectedDataset = row.dataset.dataset;</span>
<span class="sd">            console.log(&#39;Selected dataset:&#39;, selectedDataset);</span>
<span class="sd">            google.colab.kernel.invokeFunction(&#39;{{callback_id}}&#39;, [selectedDataset], {});</span>

<span class="sd">        }</span>

<span class="sd">        table.addEventListener(&#39;click&#39;, (event) =&gt; {</span>
<span class="sd">            const row = event.target.closest(&#39;tr&#39;);</span>
<span class="sd">            if (!row || !row.dataset.dataset) return;</span>
<span class="sd">            selectRow(row);</span>
<span class="sd">        });</span>

<span class="sd">        // Select the first row by default</span>
<span class="sd">        const firstRow = table.querySelector(&#39;tr[data-dataset]&#39;);</span>
<span class="sd">        if (firstRow) {</span>
<span class="sd">            selectRow(firstRow);</span>
<span class="sd">        }</span>
<span class="sd">    }</span>

<span class="sd">    // Run the initialization function after a short delay to ensure the DOM is ready</span>
<span class="sd">    setTimeout(initializeTableInteraction, 1000);</span>
<span class="sd">    &quot;&quot;&quot;</span>
            <span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">callback_id</span><span class="o">=</span><span class="n">callback_id</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.DatasetSearchInterface.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">collections</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#geemap.ai.DatasetSearchInterface.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Initializes the DatasetSearchInterface.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query</code></td>
        <td><code>str</code></td>
        <td><p>The search query string.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>collections</code></td>
        <td><code>CollectionList</code></td>
        <td><p>The list of dataset collections.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">collections</span><span class="p">:</span> <span class="n">CollectionList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the DatasetSearchInterface.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str): The search query string.</span>
<span class="sd">        collections (CollectionList): The list of dataset collections.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="n">query</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">collections</span> <span class="o">=</span> <span class="n">collections</span>

    <span class="c1"># Create the output widgets</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">code_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;50%&quot;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">details_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="s2">&quot;300px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="c1"># Initialize dataset table</span>
    <span class="n">table_html</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_table_html</span><span class="p">(</span><span class="n">collections</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dataset_table</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">table_html</span><span class="p">)</span>

    <span class="n">_callback_id</span> <span class="o">=</span> <span class="s2">&quot;dataset-select&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
    <span class="n">output</span><span class="o">.</span><span class="n">register_callback</span><span class="p">(</span><span class="n">_callback_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_outputs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_select_js_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataset_select_js_code</span><span class="p">(</span><span class="n">_callback_id</span><span class="p">)</span>
    <span class="c1"># self._dataset_select_js_code(_callback_id)</span>

    <span class="c1"># Initialize map</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">map_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">geemap_instance</span> <span class="o">=</span> <span class="n">Map</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="s2">&quot;600px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.DatasetSearchInterface.display" class="doc doc-heading">
<code class="highlight language-python"><span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


<a href="#geemap.ai.DatasetSearchInterface.display" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Display the UI in the cell.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">display</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Display the UI in the cell.&quot;&quot;&quot;</span>
    <span class="c1"># Create title and description with Material Design styling</span>
    <span class="c1"># title = widgets.HTML(value=&#39;&lt;h2 class=&quot;main-title&quot;&gt;Earth Engine Dataset Explorer&lt;/h2&gt;&#39;)</span>

    <span class="c1"># Wrap outputs in a widget box for border styling</span>
    <span class="n">details_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">details_output</span><span class="p">],</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
            <span class="n">border</span><span class="o">=</span><span class="s2">&quot;1px solid #E0E0E0&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10px&quot;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="n">code_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">code_output</span><span class="p">],</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
            <span class="n">border</span><span class="o">=</span><span class="s2">&quot;1px solid #E0E0E0&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10px&quot;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">map_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">map_output</span><span class="p">],</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
            <span class="n">border</span><span class="o">=</span><span class="s2">&quot;1px solid #E0E0E0&quot;</span><span class="p">,</span>
            <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10px&quot;</span><span class="p">,</span>
            <span class="n">margin</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span>
            <span class="n">height</span><span class="o">=</span><span class="s2">&quot;600x&quot;</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Create the vertical box for code and details</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">details_code_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
        <span class="p">[</span><span class="n">details_widget</span><span class="p">,</span> <span class="n">code_widget</span><span class="p">],</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;50%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;600px&quot;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Create a horizontal box for map and details/code</span>
    <span class="n">map_details_code_box</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">(</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">map_widget</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">details_code_box</span><span class="p">],</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
            <span class="n">border</span><span class="o">=</span><span class="s2">&quot;1px solid #E0E0E0&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10px&quot;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Create the main layout with Material Design styling</span>
    <span class="n">main_content</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dataset_table</span><span class="p">,</span> <span class="n">map_details_code_box</span><span class="p">],</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
            <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">border</span><span class="o">=</span><span class="s2">&quot;1px solid #E0E0E0&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;10px&quot;</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="s2">&quot;5px&quot;</span>
        <span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># Add debug panel to the main layout</span>
    <span class="n">main_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="c1"># title,</span>
            <span class="n">main_content</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="s2">&quot;1500px&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="s2">&quot;24px&quot;</span><span class="p">),</span>
    <span class="p">)</span>

    <span class="c1"># @title CSS</span>
    <span class="c1"># Custom CSS for Material Design styling with enhanced table styling, chat panel, and debug panel</span>
    <span class="n">CSS</span> <span class="o">=</span> <span class="n">syntax</span><span class="o">.</span><span class="n">css</span><span class="p">(</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    @import url(&#39;https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&amp;display=swap&#39;);</span>

<span class="sd">    body {</span>
<span class="sd">        font-family: &#39;Roboto&#39;, sans-serif;</span>
<span class="sd">        margin: 0;</span>
<span class="sd">        padding: 0;</span>
<span class="sd">    }</span>

<span class="sd">    .main-title {</span>
<span class="sd">        font-size: 24px;</span>
<span class="sd">        font-weight: 500;</span>
<span class="sd">        color: #212121;</span>
<span class="sd">        margin-bottom: 16px;</span>
<span class="sd">    }</span>

<span class="sd">    .custom-title {</span>
<span class="sd">        font-size: 18px;</span>
<span class="sd">        font-weight: 500;</span>
<span class="sd">        color: #212121;</span>
<span class="sd">        margin-bottom: 12px;</span>
<span class="sd">    }</span>

<span class="sd">    .details-text {</span>
<span class="sd">        font-size: 14px;</span>
<span class="sd">        color: #616161;</span>
<span class="sd">        line-height: 1.5;</span>
<span class="sd">    }</span>

<span class="sd">    .custom-table {</span>
<span class="sd">        width: 100%;</span>
<span class="sd">        border-collapse: collapse;</span>
<span class="sd">        margin-bottom: 24px;</span>
<span class="sd">        font-family: &#39;Roboto&#39;, sans-serif;</span>
<span class="sd">    }</span>
<span class="sd">    .custom-table th, .custom-table td {</span>
<span class="sd">        text-align: left;</span>
<span class="sd">        padding: 12px;</span>
<span class="sd">        border-bottom: 1px solid #E0E0E0;</span>
<span class="sd">    }</span>
<span class="sd">    .custom-table th {</span>
<span class="sd">        background-color: #F5F5F5;</span>
<span class="sd">        font-weight: 500;</span>
<span class="sd">        color: #212121;</span>
<span class="sd">    }</span>
<span class="sd">    .custom-table tr:hover {</span>
<span class="sd">        background-color: #E3F2FD;</span>
<span class="sd">    }</span>
<span class="sd">    .custom-table tr.selected {</span>
<span class="sd">        background-color: #BBDEFB;</span>
<span class="sd">    }</span>

<span class="sd">    /* Ensure borders are visible */</span>
<span class="sd">    .jupyter-widgets.widget-box {</span>
<span class="sd">        border: 1px solid #E0E0E0 !important;</span>
<span class="sd">        overflow: auto;</span>
<span class="sd">    }</span>

<span class="sd">    /* Make the map span full width */</span>
<span class="sd">    .geemap-container {</span>
<span class="sd">        width: 100% !important;</span>
<span class="sd">        height: 600px !important;</span>
<span class="sd">    }</span>

<span class="sd">    # Disable table clicks while things are loading</span>
<span class="sd">    .disabled {</span>
<span class="sd">    pointer-events: none;</span>
<span class="sd">    /* You might also want to visually indicate the disabled state */</span>
<span class="sd">    opacity: 0.5;</span>
<span class="sd">    cursor: default;</span>
<span class="sd">    }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Display the widget</span>
    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;style&gt;</span><span class="si">{</span><span class="n">CSS</span><span class="si">}</span><span class="s2">&lt;/style&gt;&quot;</span><span class="p">))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">main_layout</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Javascript</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataset_select_js_code</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.DatasetSearchInterface.update_outputs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">update_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_dataset</span><span class="p">)</span></code>


<a href="#geemap.ai.DatasetSearchInterface.update_outputs" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Updates the output widgets based on the selected dataset.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>selected_dataset</code></td>
        <td><code>str</code></td>
        <td><p>The ID of the selected dataset.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">update_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_dataset</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Updates the output widgets based on the selected dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        selected_dataset (str): The ID of the selected dataset.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">filter_by_ids</span><span class="p">([</span><span class="n">selected_dataset</span><span class="p">])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">collection</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">details_code_box</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">visibility</span> <span class="o">=</span> <span class="s2">&quot;hidden&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_widget</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">visibility</span> <span class="o">=</span> <span class="s2">&quot;hidden&quot;</span>
        <span class="k">return</span>

    <span class="n">dataset</span> <span class="o">=</span> <span class="n">collection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Clear everything when a new dataset is selected.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">map_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">code_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">details_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>
    <span class="c1"># Clear previous layers. Keep only the base layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">geemap_instance</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">geemap_instance</span><span class="o">.</span><span class="n">layers</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_output</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&lt;h3&gt;Loading...&lt;/h3&gt;&quot;</span><span class="p">))</span>
        <span class="n">code</span> <span class="o">=</span> <span class="n">fix_ee_python_code</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">python_code</span><span class="p">(),</span> <span class="n">ee</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">geemap_instance</span><span class="p">)</span>
        <span class="n">llm_thoughts</span> <span class="o">=</span> <span class="n">explain_relevance_from_stac_json</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">query</span><span class="p">,</span> <span class="n">dataset</span><span class="o">.</span><span class="n">stac_json</span>
        <span class="p">)</span>

    <span class="c1"># Code and LLM thought content is now fully loaded.</span>
    <span class="c1"># We ought to make this asynchronous in another version</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">map_output</span><span class="o">.</span><span class="n">clear_output</span><span class="p">()</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_output</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;div class=&quot;custom-title&quot;&gt;Earth Engine Code&lt;/div&gt;&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">details_output</span><span class="p">:</span>
        <span class="c1"># display(HTML(&#39;&lt;h3&gt;Thinking...&lt;/h3&gt;&#39;))</span>
        <span class="c1"># self.details_output.clear_output()</span>
        <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">&#39;&lt;div class=&quot;custom-title&quot;&gt;Thoughts with Gemini&lt;/div&gt;&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">llm_thoughts</span><span class="p">)</span>

    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_output</span><span class="p">:</span>
        <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geemap_instance</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">details_code_box</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">visibility</span> <span class="o">=</span> <span class="s2">&quot;visible&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">map_widget</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">visibility</span> <span class="o">=</span> <span class="s2">&quot;visible&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="geemap.ai.EarthEngineDatasetIndex" class="doc doc-heading">
        <code>
EarthEngineDatasetIndex        </code>



<a href="#geemap.ai.EarthEngineDatasetIndex" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Class for indexing and searching Earth Engine datasets.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">EarthEngineDatasetIndex</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for indexing and searching Earth Engine datasets.&quot;&quot;&quot;</span>

    <span class="n">index</span><span class="p">:</span> <span class="n">VectorStoreIndexWrapper</span>
    <span class="n">vectorstore</span><span class="p">:</span> <span class="n">VectorStore</span>
    <span class="n">data_catalog</span><span class="p">:</span> <span class="n">Catalog</span>
    <span class="n">llm</span><span class="p">:</span> <span class="n">BaseLanguageModel</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_catalog</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">llm</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the EarthEngineDatasetIndex.</span>

<span class="sd">        Args:</span>
<span class="sd">            data_catalog (Catalog): The data catalog containing the datasets.</span>
<span class="sd">            index (VectorStoreIndexWrapper): The vector store index wrapper.</span>
<span class="sd">            llm (BaseLanguageModel): The language model for query processing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_catalog</span> <span class="o">=</span> <span class="n">data_catalog</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vectorstore</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">vectorstore</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">llm</span> <span class="o">=</span> <span class="n">llm</span>

    <span class="nd">@tenacity</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span>
        <span class="n">stop</span><span class="o">=</span><span class="n">stop_after_attempt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
        <span class="n">wait</span><span class="o">=</span><span class="n">wait_exponential</span><span class="p">(</span><span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
        <span class="n">retry</span><span class="o">=</span><span class="n">retry_if_exception_type</span><span class="p">(</span>
            <span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">,</span> <span class="ne">ConnectionError</span><span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">find_top_matches</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
        <span class="n">bounding_box</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">temporal_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CollectionList</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve relevant datasets from the Earth Engine data catalog.</span>

<span class="sd">        Args:</span>
<span class="sd">            query (str): The kind of data being searched for, e.g., &#39;population&#39;.</span>
<span class="sd">            results (int): The number of datasets to return. Defaults to 10.</span>
<span class="sd">            threshold (float): The maximum dot product between the query and catalog embeddings.</span>
<span class="sd">                Defaults to 0.7.</span>
<span class="sd">            bounding_box (Optional[List[float]]): The spatial bounding box for the query,</span>
<span class="sd">                in the format [lon1, lat1, lon2, lon2]. Defaults to None.</span>
<span class="sd">            temporal_interval (Optional[Tuple[datetime.datetime, datetime.datetime]]):</span>
<span class="sd">            Temporal constraints as a tuple of datetime objects. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            CollectionList: A list of collections that match the query.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">similar_docs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">vectorstore</span><span class="o">.</span><span class="n">similarity_search_with_score</span><span class="p">(</span>
            <span class="n">query</span><span class="p">,</span> <span class="n">llm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">llm</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">results</span>
        <span class="p">)</span>
        <span class="n">dataset_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">page_content</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">similar_docs</span><span class="p">]</span>
        <span class="n">datasets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_catalog</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">filter_by_ids</span><span class="p">(</span><span class="n">dataset_ids</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">datasets</span>

    <span class="nd">@tenacity</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span>
        <span class="n">stop</span><span class="o">=</span><span class="n">stop_after_attempt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
        <span class="n">wait</span><span class="o">=</span><span class="n">wait_exponential</span><span class="p">(</span><span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
        <span class="n">retry</span><span class="o">=</span><span class="n">retry_if_exception_type</span><span class="p">(</span>
            <span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">,</span> <span class="ne">ConnectionError</span><span class="p">)</span>
        <span class="p">),</span>
    <span class="p">)</span>
    <span class="k">def</span> <span class="nf">find_top_matches_with_score_df</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
        <span class="n">bounding_box</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">temporal_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve relevant datasets and their match scores as a DataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">            query (str): The kind of data being searched for, e.g., &#39;population&#39;.</span>
<span class="sd">            results (int): The number of datasets to return. Defaults to 20.</span>
<span class="sd">            threshold (float): The maximum dot product between the query and catalog embeddings.</span>
<span class="sd">                Defaults to 0.7.</span>
<span class="sd">            bounding_box (Optional[List[float]]): The spatial bounding box for the query,</span>
<span class="sd">                in the format [lon1, lat1, lon2, lon2]. Defaults to None.</span>
<span class="sd">            temporal_interval (Optional[Tuple[datetime.datetime, datetime.datetime]]):</span>
<span class="sd">                Temporal constraints as a tuple of datetime objects. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: A DataFrame containing the dataset IDs and their match scores.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">scores_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids_to_match_scores_df</span><span class="p">(</span>
            <span class="n">query</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">bounding_box</span><span class="p">,</span> <span class="n">temporal_interval</span>
        <span class="p">)</span>
        <span class="n">dataset_ids</span> <span class="o">=</span> <span class="n">scores_df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">col_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_catalog</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">filter_by_ids</span><span class="p">(</span><span class="n">dataset_ids</span><span class="p">)</span>
        <span class="n">collection_df</span> <span class="o">=</span> <span class="n">col_list</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">collection_df</span><span class="p">,</span> <span class="n">scores_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;match_score&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">ids_to_match_scores_df</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">results</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">bounding_box</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">temporal_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert dataset IDs and match scores to a DataFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">            query (str): The kind of data being searched for, e.g., &#39;population&#39;.</span>
<span class="sd">            results (int): The number of datasets to return.</span>
<span class="sd">            bounding_box (Optional[List[float]]): The spatial bounding box for the query,</span>
<span class="sd">                in the format [lon1, lat1, lon2, lon2]. Defaults to None.</span>
<span class="sd">            temporal_interval (Optional[Tuple[datetime.datetime, datetime.datetime]]):</span>
<span class="sd">                Temporal constraints as a tuple of datetime objects. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            pd.DataFrame: A DataFrame containing the dataset IDs and their match scores.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">similar_docs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">vectorstore</span><span class="o">.</span><span class="n">similarity_search_with_score</span><span class="p">(</span>
            <span class="n">query</span><span class="p">,</span> <span class="n">llm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">llm</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">results</span>
        <span class="p">)</span>
        <span class="n">dataset_ids</span><span class="p">,</span> <span class="n">scores</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
            <span class="o">*</span><span class="p">[(</span><span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">page_content</span><span class="p">,</span> <span class="n">doc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">similar_docs</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">dataset_ids</span><span class="p">,</span> <span class="s2">&quot;match_score&quot;</span><span class="p">:</span> <span class="n">scores</span><span class="p">})</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.EarthEngineDatasetIndex.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_catalog</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">llm</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#geemap.ai.EarthEngineDatasetIndex.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Initializes the EarthEngineDatasetIndex.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>data_catalog</code></td>
        <td><code>Catalog</code></td>
        <td><p>The data catalog containing the datasets.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>index</code></td>
        <td><code>VectorStoreIndexWrapper</code></td>
        <td><p>The vector store index wrapper.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>llm</code></td>
        <td><code>BaseLanguageModel</code></td>
        <td><p>The language model for query processing.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_catalog</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">llm</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the EarthEngineDatasetIndex.</span>

<span class="sd">    Args:</span>
<span class="sd">        data_catalog (Catalog): The data catalog containing the datasets.</span>
<span class="sd">        index (VectorStoreIndexWrapper): The vector store index wrapper.</span>
<span class="sd">        llm (BaseLanguageModel): The language model for query processing.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data_catalog</span> <span class="o">=</span> <span class="n">data_catalog</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vectorstore</span> <span class="o">=</span> <span class="n">index</span><span class="o">.</span><span class="n">vectorstore</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">llm</span> <span class="o">=</span> <span class="n">llm</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.EarthEngineDatasetIndex.find_top_matches" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_top_matches</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">bounding_box</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">temporal_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#geemap.ai.EarthEngineDatasetIndex.find_top_matches" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Retrieve relevant datasets from the Earth Engine data catalog.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query</code></td>
        <td><code>str</code></td>
        <td><p>The kind of data being searched for, e.g., 'population'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>results</code></td>
        <td><code>int</code></td>
        <td><p>The number of datasets to return. Defaults to 10.</p></td>
        <td><code>10</code></td>
      </tr>
      <tr>
        <td><code>threshold</code></td>
        <td><code>float</code></td>
        <td><p>The maximum dot product between the query and catalog embeddings.
Defaults to 0.7.</p></td>
        <td><code>0.7</code></td>
      </tr>
      <tr>
        <td><code>bounding_box</code></td>
        <td><code>Optional[List[float]]</code></td>
        <td><p>The spatial bounding box for the query,
in the format [lon1, lat1, lon2, lon2]. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>temporal_interval</code></td>
        <td><code>Optional[Tuple[datetime.datetime, datetime.datetime]]</code></td>
        <td></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>CollectionList</code></td>
      <td><p>A list of collections that match the query.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@tenacity</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span>
    <span class="n">stop</span><span class="o">=</span><span class="n">stop_after_attempt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">wait</span><span class="o">=</span><span class="n">wait_exponential</span><span class="p">(</span><span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">retry</span><span class="o">=</span><span class="n">retry_if_exception_type</span><span class="p">(</span>
        <span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">,</span> <span class="ne">ConnectionError</span><span class="p">)</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">find_top_matches</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="n">bounding_box</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">temporal_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">CollectionList</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve relevant datasets from the Earth Engine data catalog.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str): The kind of data being searched for, e.g., &#39;population&#39;.</span>
<span class="sd">        results (int): The number of datasets to return. Defaults to 10.</span>
<span class="sd">        threshold (float): The maximum dot product between the query and catalog embeddings.</span>
<span class="sd">            Defaults to 0.7.</span>
<span class="sd">        bounding_box (Optional[List[float]]): The spatial bounding box for the query,</span>
<span class="sd">            in the format [lon1, lat1, lon2, lon2]. Defaults to None.</span>
<span class="sd">        temporal_interval (Optional[Tuple[datetime.datetime, datetime.datetime]]):</span>
<span class="sd">        Temporal constraints as a tuple of datetime objects. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        CollectionList: A list of collections that match the query.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">similar_docs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">vectorstore</span><span class="o">.</span><span class="n">similarity_search_with_score</span><span class="p">(</span>
        <span class="n">query</span><span class="p">,</span> <span class="n">llm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">llm</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">results</span>
    <span class="p">)</span>
    <span class="n">dataset_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">page_content</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">similar_docs</span><span class="p">]</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_catalog</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">filter_by_ids</span><span class="p">(</span><span class="n">dataset_ids</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">datasets</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.EarthEngineDatasetIndex.find_top_matches_with_score_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">find_top_matches_with_score_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">bounding_box</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">temporal_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#geemap.ai.EarthEngineDatasetIndex.find_top_matches_with_score_df" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Retrieve relevant datasets and their match scores as a DataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query</code></td>
        <td><code>str</code></td>
        <td><p>The kind of data being searched for, e.g., 'population'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>results</code></td>
        <td><code>int</code></td>
        <td><p>The number of datasets to return. Defaults to 20.</p></td>
        <td><code>20</code></td>
      </tr>
      <tr>
        <td><code>threshold</code></td>
        <td><code>float</code></td>
        <td><p>The maximum dot product between the query and catalog embeddings.
Defaults to 0.7.</p></td>
        <td><code>0.7</code></td>
      </tr>
      <tr>
        <td><code>bounding_box</code></td>
        <td><code>Optional[List[float]]</code></td>
        <td><p>The spatial bounding box for the query,
in the format [lon1, lat1, lon2, lon2]. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>temporal_interval</code></td>
        <td><code>Optional[Tuple[datetime.datetime, datetime.datetime]]</code></td>
        <td><p>Temporal constraints as a tuple of datetime objects. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>A DataFrame containing the dataset IDs and their match scores.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@tenacity</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span>
    <span class="n">stop</span><span class="o">=</span><span class="n">stop_after_attempt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">wait</span><span class="o">=</span><span class="n">wait_exponential</span><span class="p">(</span><span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">retry</span><span class="o">=</span><span class="n">retry_if_exception_type</span><span class="p">(</span>
        <span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">,</span> <span class="ne">ConnectionError</span><span class="p">)</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">find_top_matches_with_score_df</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
    <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="n">bounding_box</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">temporal_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve relevant datasets and their match scores as a DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str): The kind of data being searched for, e.g., &#39;population&#39;.</span>
<span class="sd">        results (int): The number of datasets to return. Defaults to 20.</span>
<span class="sd">        threshold (float): The maximum dot product between the query and catalog embeddings.</span>
<span class="sd">            Defaults to 0.7.</span>
<span class="sd">        bounding_box (Optional[List[float]]): The spatial bounding box for the query,</span>
<span class="sd">            in the format [lon1, lat1, lon2, lon2]. Defaults to None.</span>
<span class="sd">        temporal_interval (Optional[Tuple[datetime.datetime, datetime.datetime]]):</span>
<span class="sd">            Temporal constraints as a tuple of datetime objects. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A DataFrame containing the dataset IDs and their match scores.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">scores_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ids_to_match_scores_df</span><span class="p">(</span>
        <span class="n">query</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">bounding_box</span><span class="p">,</span> <span class="n">temporal_interval</span>
    <span class="p">)</span>
    <span class="n">dataset_ids</span> <span class="o">=</span> <span class="n">scores_df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">col_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_catalog</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">filter_by_ids</span><span class="p">(</span><span class="n">dataset_ids</span><span class="p">)</span>
    <span class="n">collection_df</span> <span class="o">=</span> <span class="n">col_list</span><span class="o">.</span><span class="n">to_df</span><span class="p">()</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">collection_df</span><span class="p">,</span> <span class="n">scores_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;inner&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;match_score&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.EarthEngineDatasetIndex.ids_to_match_scores_df" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ids_to_match_scores_df</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">bounding_box</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">temporal_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


<a href="#geemap.ai.EarthEngineDatasetIndex.ids_to_match_scores_df" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Convert dataset IDs and match scores to a DataFrame.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query</code></td>
        <td><code>str</code></td>
        <td><p>The kind of data being searched for, e.g., 'population'.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>results</code></td>
        <td><code>int</code></td>
        <td><p>The number of datasets to return.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>bounding_box</code></td>
        <td><code>Optional[List[float]]</code></td>
        <td><p>The spatial bounding box for the query,
in the format [lon1, lat1, lon2, lon2]. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>temporal_interval</code></td>
        <td><code>Optional[Tuple[datetime.datetime, datetime.datetime]]</code></td>
        <td><p>Temporal constraints as a tuple of datetime objects. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>pd.DataFrame</code></td>
      <td><p>A DataFrame containing the dataset IDs and their match scores.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ids_to_match_scores_df</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">results</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">bounding_box</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">temporal_interval</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert dataset IDs and match scores to a DataFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str): The kind of data being searched for, e.g., &#39;population&#39;.</span>
<span class="sd">        results (int): The number of datasets to return.</span>
<span class="sd">        bounding_box (Optional[List[float]]): The spatial bounding box for the query,</span>
<span class="sd">            in the format [lon1, lat1, lon2, lon2]. Defaults to None.</span>
<span class="sd">        temporal_interval (Optional[Tuple[datetime.datetime, datetime.datetime]]):</span>
<span class="sd">            Temporal constraints as a tuple of datetime objects. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        pd.DataFrame: A DataFrame containing the dataset IDs and their match scores.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">similar_docs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">vectorstore</span><span class="o">.</span><span class="n">similarity_search_with_score</span><span class="p">(</span>
        <span class="n">query</span><span class="p">,</span> <span class="n">llm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">llm</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">results</span>
    <span class="p">)</span>
    <span class="n">dataset_ids</span><span class="p">,</span> <span class="n">scores</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="o">*</span><span class="p">[(</span><span class="n">doc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">page_content</span><span class="p">,</span> <span class="n">doc</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">similar_docs</span><span class="p">]</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">dataset_ids</span><span class="p">,</span> <span class="s2">&quot;match_score&quot;</span><span class="p">:</span> <span class="n">scores</span><span class="p">})</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="geemap.ai.Genie" class="doc doc-heading">
        <code>
Genie            (<span title="ipywidgets.widgets.widget_box.VBox">VBox</span>)
        </code>



<a href="#geemap.ai.Genie" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>A widget for interacting with the Genie AI model.</p>
<p>The source code is adapted from the ee_genie.ipynb at <a href="https://bit.ly/3YEm7B6">https://bit.ly/3YEm7B6</a>.
Credit to the original author Simon Ilyushchenko (<a href="https://github.com/simonff">https://github.com/simonff</a>).</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>project</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Google Cloud project ID. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>google_api_key</code></td>
        <td><code>Optional[str]</code></td>
        <td><p>Google API key. Defaults to None.</p></td>
        <td><code>None</code></td>
      </tr>
      <tr>
        <td><code>gemini_model</code></td>
        <td><code>str</code></td>
        <td><p>The Gemini model to use. Defaults to "gemini-1.5-flash".
For a list of available models, see https://bit.ly/4fKfXW7.</p></td>
        <td><code>&#39;gemini-1.5-flash&#39;</code></td>
      </tr>
      <tr>
        <td><code>target_score</code></td>
        <td><code>float</code></td>
        <td><p>The target score for the model. Defaults to 0.8.</p></td>
        <td><code>0.8</code></td>
      </tr>
      <tr>
        <td><code>widget_height</code></td>
        <td><code>str</code></td>
        <td><p>The height of the widget. Defaults to "600px".</p></td>
        <td><code>&#39;600px&#39;</code></td>
      </tr>
      <tr>
        <td><code>initialize_ee</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to initialize Earth Engine. Defaults to True.</p></td>
        <td><code>True</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>ValueError</code></td>
        <td><p>If the project ID or Google API key is not provided.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Genie</span><span class="p">(</span><span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A widget for interacting with the Genie AI model.</span>

<span class="sd">    The source code is adapted from the ee_genie.ipynb at &lt;https://bit.ly/3YEm7B6&gt;.</span>
<span class="sd">    Credit to the original author Simon Ilyushchenko (&lt;https://github.com/simonff&gt;).</span>

<span class="sd">    Args:</span>
<span class="sd">        project (Optional[str], optional): Google Cloud project ID. Defaults to None.</span>
<span class="sd">        google_api_key (Optional[str], optional): Google API key. Defaults to None.</span>
<span class="sd">        gemini_model (str, optional): The Gemini model to use. Defaults to &quot;gemini-1.5-flash&quot;.</span>
<span class="sd">            For a list of available models, see https://bit.ly/4fKfXW7.</span>
<span class="sd">        target_score (float, optional): The target score for the model. Defaults to 0.8.</span>
<span class="sd">        widget_height (str, optional): The height of the widget. Defaults to &quot;600px&quot;.</span>
<span class="sd">        initialize_ee (bool, optional): Whether to initialize Earth Engine. Defaults to True.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the project ID or Google API key is not provided.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">project</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">google_api_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">gemini_model</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gemini-1.5-flash&quot;</span><span class="p">,</span>
        <span class="n">target_score</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span>
        <span class="n">widget_height</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;600px&quot;</span><span class="p">,</span>
        <span class="n">initialize_ee</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Initialization</span>

        <span class="k">if</span> <span class="n">project</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">project</span> <span class="o">=</span> <span class="n">get_env_var</span><span class="p">(</span><span class="s2">&quot;EE_PROJECT_ID&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">get_env_var</span><span class="p">(</span><span class="s2">&quot;GOOGLE_PROJECT_ID&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">project</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Please provide a valid project ID via the &#39;project&#39; parameter.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">google_api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">google_api_key</span> <span class="o">=</span> <span class="n">get_env_var</span><span class="p">(</span><span class="s2">&quot;GOOGLE_API_KEY&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">google_api_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Please provide a valid Google API key via the &#39;google_api_key&#39; parameter.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">initialize_ee</span><span class="p">:</span>
            <span class="n">ee_initialize</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">)</span>

        <span class="n">genai</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">api_key</span><span class="o">=</span><span class="n">google_api_key</span><span class="p">)</span>
        <span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project</span><span class="p">)</span>
        <span class="n">bucket</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">get_bucket</span><span class="p">(</span><span class="s2">&quot;earthengine-stac&quot;</span><span class="p">)</span>

        <span class="c1"># Score to aim for (on the 0-1 scale). The exact meaning of what &quot;score&quot; means</span>
        <span class="c1"># is left to the LLM.</span>

        <span class="c1"># Count of analysis rounds</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">iteration</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_dirty</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">m</span> <span class="o">=</span> <span class="n">Map</span><span class="p">()</span>
        <span class="n">m</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;layer_manager&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="o">=</span> <span class="n">m</span>

        <span class="n">analysis_model</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">image_model</span> <span class="o">=</span> <span class="n">genai</span><span class="o">.</span><span class="n">GenerativeModel</span><span class="p">(</span><span class="n">gemini_model</span><span class="p">)</span>

        <span class="c1"># UI widget definitions</span>

        <span class="c1"># We define the widgets early because some functions will write to the debug</span>
        <span class="c1"># and/or chat panels.</span>

        <span class="n">command_input</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span>
            <span class="n">value</span><span class="o">=</span><span class="s2">&quot;show a whole continent Australia DEM visualization using a palette that captures the elevation range&quot;</span><span class="p">,</span>
            <span class="c1"># value=&#39;show NYC&#39;,</span>
            <span class="c1"># value=&#39;show an area with many center pivot irrigation circles&#39;,</span>
            <span class="c1"># value=&#39;show a fire scar&#39;,</span>
            <span class="c1"># value=&#39;show an open pit mine&#39;,</span>
            <span class="c1"># value=&#39;a sea port&#39;,</span>
            <span class="c1"># value=&#39;flood consequences&#39;,</span>
            <span class="c1"># value=&#39;show an interesting modis composite with the relevant visualization and analyze it over Costa Rica&#39;,</span>
            <span class="n">description</span><span class="o">=</span><span class="s2">&quot;❓&quot;</span><span class="p">,</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;100%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;50px&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">command_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span>
            <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Last command will be here&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">status_label</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Textarea</span><span class="p">(</span>
            <span class="n">value</span><span class="o">=</span><span class="s2">&quot;LLM response will be here&quot;</span><span class="p">,</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;50%&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s2">&quot;100px&quot;</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="c1"># widget_height = &quot;600px&quot;</span>
        <span class="n">debug_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span>
            <span class="n">layout</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;border&quot;</span><span class="p">:</span> <span class="s2">&quot;1px solid black&quot;</span><span class="p">,</span>
                <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">widget_height</span><span class="p">,</span>
                <span class="s2">&quot;overflow&quot;</span><span class="p">:</span> <span class="s2">&quot;scroll&quot;</span><span class="p">,</span>
                <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="s2">&quot;500px&quot;</span><span class="p">,</span>
                <span class="s2">&quot;padding&quot;</span><span class="p">:</span> <span class="s2">&quot;5px&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>
        <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;DEBUG COLUMN</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">logo</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;https://drive.usercontent.google.com/download?id=1zE6G_nxXa3G5N0G_32jEhzdum2kMDfNY&amp;export=view&amp;authuser=0&quot;</span>
        <span class="p">)</span><span class="o">.</span><span class="n">content</span>

        <span class="n">image_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">logo</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

        <span class="n">chat_output</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">(</span>
            <span class="n">layout</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;border&quot;</span><span class="p">:</span> <span class="s2">&quot;1px solid black&quot;</span><span class="p">,</span>
                <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="s2">&quot;600px&quot;</span><span class="p">,</span>
                <span class="s2">&quot;overflow&quot;</span><span class="p">:</span> <span class="s2">&quot;scroll&quot;</span><span class="p">,</span>
                <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="s2">&quot;300px&quot;</span><span class="p">,</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="k">with</span> <span class="n">chat_output</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CHAT COLUMN</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Simple functions that LLM will call</span>

        <span class="k">def</span> <span class="nf">set_center</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">zoom</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Sets the map center to the given coordinates and zoom level and</span>
<span class="sd">            returns instructions on what to do next.&quot;&quot;&quot;</span>
            <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SET_CENTER(</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">y</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">zoom</span><span class="si">}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">set_center</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">m</span><span class="o">.</span><span class="n">zoom</span> <span class="o">=</span> <span class="n">zoom</span>
            <span class="c1"># global map_dirty</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map_dirty</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="s2">&quot;Do not call any more functions in this request to let geemap bounds &quot;</span>
                <span class="s2">&quot;update. Wait for user input.&quot;</span>
            <span class="p">)</span>

        <span class="k">def</span> <span class="nf">add_image_layer</span><span class="p">(</span><span class="n">image_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Adds to the map center an ee.Image with the given id</span>
<span class="sd">            and returns status message (success or failure).&quot;&quot;&quot;</span>
            <span class="n">m</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">command_output</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;add_image_layer(&#39;</span><span class="si">{</span><span class="n">image_id</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>
            <span class="n">m</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">image_id</span><span class="p">))</span>
            <span class="k">return</span> <span class="s2">&quot;success&quot;</span>

        <span class="k">def</span> <span class="nf">get_dataset_description</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Fetches JSON STAC description for the given Earth Engine dataset id.&quot;&quot;&quot;</span>
            <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;LOOKING UP </span><span class="si">{</span><span class="n">dataset_id</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">dataset_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># Get the blob (file)</span>
            <span class="n">path</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;catalog&quot;</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">dataset_id</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;.json&quot;</span>
            <span class="p">)</span>
            <span class="n">blob</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">blob</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
                <span class="k">return</span> <span class="s2">&quot;dataset file not found: &quot;</span> <span class="o">+</span> <span class="n">path</span>

            <span class="n">file_contents</span> <span class="o">=</span> <span class="n">blob</span><span class="o">.</span><span class="n">download_as_string</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">file_contents</span>

        <span class="k">def</span> <span class="nf">get_image</span><span class="p">(</span><span class="n">image_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Fetches from Earth Engine the content of the given URL as bytes.&quot;&quot;&quot;</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">image_url</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
                <span class="n">image_widget</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span>
                <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">content</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">error_message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Error downloading image: </span><span class="si">{</span><span class="n">response</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">error_details</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
                        <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="p">{})</span>
                        <span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;message&quot;</span><span class="p">)</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">error_details</span><span class="p">:</span>
                        <span class="n">error_message</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; - </span><span class="si">{</span><span class="n">error_details</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">error_message</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;URL </span><span class="si">%s</span><span class="s2"> causes </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">image_url</span><span class="p">,</span> <span class="n">error_message</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">show_layer</span><span class="p">(</span><span class="n">python_code</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Execute the given Earth Engine Python client code and add the result to</span>
<span class="sd">            the map. Returns the status message (success or error message).&quot;&quot;&quot;</span>
            <span class="n">m</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">layers</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">while</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&quot;&#39;</span> <span class="ow">in</span> <span class="n">python_code</span><span class="p">:</span>
                <span class="n">python_code</span> <span class="o">=</span> <span class="n">python_code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">)</span>
            <span class="n">command_output</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;show_layer(&#39;</span><span class="si">{</span><span class="n">python_code</span><span class="si">}</span><span class="s2">&#39;)&quot;</span>
            <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;IMAGE:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">python_code</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">locals</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="n">exec</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;import ee; im = </span><span class="si">{</span><span class="n">python_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="p">{},</span> <span class="nb">locals</span><span class="p">)</span>
                <span class="n">m</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="nb">locals</span><span class="p">[</span><span class="s2">&quot;im&quot;</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ERROR: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;success&quot;</span>

        <span class="k">def</span> <span class="nf">inner_monologue</span><span class="p">(</span><span class="n">thoughts</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Sends the current thinking of the LLM model to the user so that they are</span>
<span class="sd">            aware of what the model is thinking between function calls.&quot;&quot;&quot;</span>
            <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;THOUGHTS:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">thoughts</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;success&quot;</span>

        <span class="c1"># Functions for textual analysis of images</span>

        <span class="k">def</span> <span class="nf">_lat_lon_to_tile</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">zoom_level</span><span class="p">):</span>
            <span class="c1"># Convert latitude and longitude to Mercator coordinates</span>
            <span class="n">x_merc</span> <span class="o">=</span> <span class="p">(</span><span class="n">lon</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">/</span> <span class="mi">360</span>
            <span class="n">y_merc</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mi">1</span>
                <span class="o">-</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                    <span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span>
                <span class="p">)</span>
                <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span>
            <span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

            <span class="c1"># Calculate number of tiles</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="n">zoom_level</span>

            <span class="c1"># Convert to tile coordinates</span>
            <span class="n">X</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x_merc</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>
            <span class="n">Y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">y_merc</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span>

        <span class="k">def</span> <span class="nf">analyze_image</span><span class="p">(</span><span class="n">additional_instructions</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns GenAI image analysis describing the current map image.</span>
<span class="sd">            Optional additional instructions might be passed to target the analysis</span>
<span class="sd">            more precisely.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># global map_dirty</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_dirty</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;MAP DIRTY&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="s2">&quot;Map is not ready. Stop further processing and ask for user input&quot;</span>
                <span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_analyze_image</span><span class="p">(</span><span class="n">additional_instructions</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">_analyze_image</span><span class="p">(</span><span class="n">additional_instructions</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="c1"># bounds = m.bounds</span>
            <span class="c1"># s, w = bounds[0]</span>
            <span class="c1"># n, e = bounds[1]</span>
            <span class="c1"># zoom = int(m.zoom)</span>

            <span class="c1"># min_tile_x, max_tile_y = _lat_lon_to_tile(w, s, zoom)</span>
            <span class="c1"># max_tile_x, min_tile_y = _lat_lon_to_tile(e, n, zoom)</span>
            <span class="c1"># min_tile_x = max(0, min_tile_x)</span>
            <span class="c1"># max_tile_x = min(2**zoom - 1, max_tile_x)</span>
            <span class="c1"># min_tile_y = max(0, min_tile_y)</span>
            <span class="c1"># max_tile_y = min(2**zoom - 1, max_tile_y)</span>

            <span class="c1"># with debug_output:</span>
            <span class="c1">#     if additional_instructions:</span>
            <span class="c1">#         print(f&quot;RUNNING IMAGE ANALYSIS: {additional_instructions}...\n&quot;)</span>
            <span class="c1">#     else:</span>
            <span class="c1">#         print(&quot;RUNNING IMAGE ANALYSIS...\n&quot;)</span>

            <span class="c1"># layers = list(m.ee_layer_dict.values())</span>
            <span class="c1"># if not layers:</span>
            <span class="c1">#     return &quot;No data layers loaded&quot;</span>
            <span class="c1"># url_template = layers[-1][&quot;ee_layer&quot;].url</span>
            <span class="c1"># tile_width = 256</span>
            <span class="c1"># tile_height = 256</span>
            <span class="c1"># image_width = (max_tile_x - min_tile_x + 1) * tile_width</span>
            <span class="c1"># image_height = (max_tile_y - min_tile_y + 1) * tile_height</span>

            <span class="c1"># # Create a new blank image</span>
            <span class="c1"># image = PIL.Image.new(&quot;RGB&quot;, (image_width, image_height))</span>

            <span class="c1"># for y in range(min_tile_y, max_tile_y + 1):</span>
            <span class="c1">#     for x in range(min_tile_x, max_tile_x + 1):</span>
            <span class="c1">#         tile_url = str.format(url_template, x=x, y=y, z=zoom)</span>
            <span class="c1">#         # print(tile_url)</span>
            <span class="c1">#         tile_img = PIL.Image.open(io.BytesIO(get_image(tile_url)))</span>

            <span class="c1">#         offset_x = (x - min_tile_x) * tile_width</span>
            <span class="c1">#         offset_y = (y - min_tile_y) * tile_height</span>
            <span class="c1">#         image.paste(tile_img, (offset_x, offset_y))</span>

            <span class="c1"># width, height = image.size</span>
            <span class="c1"># num_bands = len(image.getbands())</span>

            <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">additional_instructions</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;RUNNING IMAGE ANALYSIS: </span><span class="si">{</span><span class="n">additional_instructions</span><span class="si">}</span><span class="s2">...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RUNNING IMAGE ANALYSIS...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">layers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">ee_layer_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">layers</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;No data layers loaded&quot;</span>
            <span class="n">image_temp_file</span> <span class="o">=</span> <span class="n">temp_file_path</span><span class="p">(</span><span class="n">extension</span><span class="o">=</span><span class="s2">&quot;jpg&quot;</span><span class="p">)</span>
            <span class="n">layer_name</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;ee_layer&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
            <span class="n">m</span><span class="o">.</span><span class="n">layer_to_image</span><span class="p">(</span><span class="n">layer_name</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">image_temp_file</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">get_scale</span><span class="p">())</span>
            <span class="n">image</span> <span class="o">=</span> <span class="n">PIL</span><span class="o">.</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_temp_file</span><span class="p">)</span>

            <span class="n">image_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
            <span class="n">image_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">image_array</span><span class="p">)</span>
            <span class="n">image_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">image_array</span><span class="p">)</span>

            <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">image_temp_file</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
            <span class="n">image_widget</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

            <span class="c1"># Skip an LLM call when we can simply tell that something is wrong.</span>
            <span class="c1"># (Also, LLMs might hallucinate on uniform images.)</span>
            <span class="k">if</span> <span class="n">image_min</span> <span class="o">==</span> <span class="n">image_max</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;The image tile has a single uniform color with value &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">image_min</span><span class="si">}</span><span class="s2">.&quot;</span>
                <span class="p">)</span>

            <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;You are an objective, precise overhead imagery analyst.</span>
<span class="s2">        Describe what the provided map tile depicts in terms of:</span>

<span class="s2">        1. The colors, textures, and patterns visible in the image.</span>
<span class="s2">        2. The spatial distribution, shape, and extent of distinct features or regions.</span>
<span class="s2">        3. Any notable contrasts, boundaries, or gradients between different areas.</span>

<span class="s2">        Avoid making assumptions about the specific geographic location, time period,</span>
<span class="s2">        or cause of the observed features. Focus solely on the literal contents of the</span>
<span class="s2">        image itself. Clearly indicate which features look natural, which look human-made,</span>
<span class="s2">        and which look like image artifacts. (Eg, a completely straight blue line</span>
<span class="s2">        is unlikely to be a river.)</span>

<span class="s2">        If the image is ambiguous or unclear, state so directly. Do not speculate or</span>
<span class="s2">        hypothesize beyond what is directly visible.</span>

<span class="s2">        If the image is of mostly the same color (white, gray, or black) with little</span>
<span class="s2">        contrast, just report that and do not describe the features.</span>

<span class="s2">        Use clear, concise language. Avoid subjective interpretations or analogies.</span>
<span class="s2">        Organize your response into structured paragraphs.</span>
<span class="s2">        &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">additional_instructions</span><span class="p">:</span>
                <span class="n">query</span> <span class="o">+=</span> <span class="n">additional_instructions</span>
            <span class="n">req</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;parts&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="n">query</span><span class="p">},</span>
                    <span class="p">{</span><span class="s2">&quot;inline_data&quot;</span><span class="p">:</span> <span class="n">image</span><span class="p">},</span>
                <span class="p">]</span>
            <span class="p">}</span>
            <span class="n">image_response</span> <span class="o">=</span> <span class="n">image_model</span><span class="o">.</span><span class="n">generate_content</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ANALYSIS RESULT: </span><span class="si">{</span><span class="n">image_response</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">image_response</span><span class="o">.</span><span class="n">text</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;UNEXPECTED IMAGE RESPONSE: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">image_response</span><span class="p">)</span>
                <span class="nb">breakpoint</span><span class="p">()</span>

        <span class="c1"># Function for scoring how well image analysis corresponds to the user query.</span>

        <span class="c1"># Note that we ask for the score outside of the main agent chat to keep</span>
        <span class="c1"># the scoring more objective.</span>

        <span class="n">scoring_system_prompt</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        After looking at the user query and the map tile analysis, start</span>
<span class="s2">        your answer with a number between 0 and 1 indicating how relevant</span>
<span class="s2">        the image is as an answer to the query. (0=irrelevant, 1=perfect answer)</span>

<span class="s2">        Make sure you have enough justification to definitively declare the analysis</span>
<span class="s2">        relevant - it&#39;s better to give a false negative than a false positive. However,</span>
<span class="s2">        the image analysis identifies specific matching landmarks (eg, the</span>
<span class="s2">        the outlines of Manhattan island for a request to show NYC), believe it.</span>

<span class="s2">        Do not assume  too much (eg, that the presence of green doesn&#39;t by itself mean the</span>
<span class="s2">        image shows forest); attempt to find multiple (at least three) independent</span>
<span class="s2">        lines of evidence before declaring victory and cite all these lines of evidence</span>
<span class="s2">        in your response.</span>

<span class="s2">        Be very, very skeptical - look for specific features that match only the query</span>
<span class="s2">        and nothing else (eg, if the query looks for a river, a completely straight blue</span>
<span class="s2">        line is unlikely to be a river). Think about what size the features are based on</span>
<span class="s2">        the zoom level and whether this size matches the feature size expected from</span>
<span class="s2">        first principles.</span>

<span class="s2">        If there is ambiguity or uncertainty, express it in your analysis and</span>
<span class="s2">        lower the score accordingly. If the image analysis is inconclusive, try zooming</span>
<span class="s2">        out to make sure you are looking at the right spot. Do not reduce the score if</span>
<span class="s2">        the analysis does not mention visualization parameters - they are just given for</span>
<span class="s2">        your reference. The image might show an area slightly larger than requested -</span>
<span class="s2">        this is okay, do not reduce the score on this account.</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">score_response</span><span class="p">(</span>
            <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">visualization_parameters</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">analysis</span><span class="p">:</span> <span class="nb">str</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Returns how well the given analysis describes a map tile returned for</span>
<span class="sd">            the given query. The analysis starts with a number between 0 and 1.</span>

<span class="sd">            Arguments:</span>
<span class="sd">            query: user-specified query</span>
<span class="sd">            visualization_parameters: description of the bands used and visualization</span>
<span class="sd">                parameters applied to the map tile</span>
<span class="sd">            analysis: the textual description of the map tile</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;VIZ PARAMS: </span><span class="si">{</span><span class="n">visualization_parameters</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">question</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;For user query </span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2"> please score the following analysis:</span>
<span class="s2">            </span><span class="si">{</span><span class="n">analysis</span><span class="si">}</span><span class="s2">. The answer must start with a number between 0 and 1.&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">visualization_parameters</span><span class="p">:</span>
                <span class="n">question</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Do not assume that common bands or visualization</span>
<span class="s2">                parameters should have been used, as the visualization used the</span>
<span class="s2">                following parameters: </span><span class="si">{</span><span class="n">visualization_parameters</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>

            <span class="n">result</span> <span class="o">=</span> <span class="n">analysis_model</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">question</span><span class="p">)</span>
            <span class="c1"># global iteration</span>
            <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SCORE #</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">iteration</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;UNEXPECTED SCORE RESPONSE: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span>

        <span class="c1"># Main prompt for the agent</span>

        <span class="n">system_prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        The client is running in a Python notebook with a geemap Map displayed.</span>
<span class="s2">        When composing Python code, do not use getMapId - just return the single-line</span>
<span class="s2">        layer definition like &#39;ee.Image(&quot;USGS/SRTMGL1_003&quot;)&#39; that we will pass to</span>
<span class="s2">        Map.addLayer(). Do not escape quotation marks in Python code.</span>

<span class="s2">        Be sure to use Python, not Javascript, syntax for keyword parameters in</span>
<span class="s2">        Python code (that is, &quot;function(arg=value)&quot;) Using the provided functions,</span>
<span class="s2">        respond to the user command following below (or respond why it&#39;s not possible).</span>
<span class="s2">        If you get an Earth Engine error, attempt to fix it and then try again.</span>

<span class="s2">        Before you choose a dataset, think about what kind of dataset would be most</span>
<span class="s2">        suitable for the query. Also think about what zoom level would be suitable for</span>
<span class="s2">        the query, keeping in mind that for high-resolution image collections higher</span>
<span class="s2">        zoom levels are better to speed up tile loading.</span>

<span class="s2">        Once you have chosen a dataset, read its description using the provided function</span>
<span class="s2">        to see what spatial and temporal range it covers, what bands it has, as well as</span>
<span class="s2">        to find the recommended visualization parameters. Explain using the inner</span>
<span class="s2">        monlogue function why you chose a specific dataset, zoom level and map location.</span>

<span class="s2">        Prefer mosaicing image collections using the mosaic() function, don&#39;t get</span>
<span class="s2">        individual images from collections via</span>
<span class="s2">        &#39;first()&#39;. Choose a tile size and zoom level that will ensure the</span>
<span class="s2">        tile has enough pixels in it to avoid graininess, but not so many</span>
<span class="s2">        that processing becomes very expensive. Do not use wide date ranges</span>
<span class="s2">        with collections that have many images, but remember that Landsat and</span>
<span class="s2">        Sentinel-2 have revisit period of several days. Do not use sample</span>
<span class="s2">        locations - try to come up with actual locations that are relevant to</span>
<span class="s2">        the request.</span>

<span class="s2">        Use Landsat Collection 2, not Landsat Collection 1 ids. If you are getting</span>
<span class="s2">        repeated errors when filtering by a time range, read the dataset description</span>
<span class="s2">        to confirm that the dataset has data for the selected range.</span>

<span class="s2">        Important: after using the set_center() function, just say that you have called</span>
<span class="s2">        this function and wait for the user to hit enter, after which you should</span>
<span class="s2">        continue answering the original request. This will make sure the map is updated</span>
<span class="s2">        on the client side.</span>

<span class="s2">        Once the map is updated and the user told you to proceed, call the analyze_image</span>
<span class="s2">        function() to describe the image for the same location that will be shown in</span>
<span class="s2">        geemap. If you pass additional instructions to analyze_image(), do not disclose</span>
<span class="s2">        what the image is supposed to be to discourage hallucinations - you can only tell</span>
<span class="s2">        the analysis function to pay attention to specific areas (eg, center or top left)</span>
<span class="s2">        or shapes (eg, a line at the bottom) in the image. You can also tell the analysis</span>
<span class="s2">        function about the chosen bands, color palette and min/max visualization</span>
<span class="s2">        parameters, if any, to help it interpret the colors correctly. If the image</span>
<span class="s2">        turns out to be uniform in color with no features,</span>
<span class="s2">        use min/max visualization parameters to enhance contrast.</span>

<span class="s2">        Frequently call the inner_monologue() functions to tell the user about your</span>
<span class="s2">        current thought process. This is a good time to reflect if you have been running</span>
<span class="s2">        into repeated errors of the same kind, and if so, to try a different approach.</span>

<span class="s2">        When you are done, call the score_response() function to evaluate the analysis.</span>
<span class="s2">        You can also tell the scoring function about the chosen bands, color palette</span>
<span class="s2">        and min/max visualization parameters, if any. If the analysis score is below</span>
<span class="s2">        </span><span class="si">{</span><span class="n">target_score</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">        keep trying to find and show a better image. You might have to change the dataset,</span>
<span class="s2">        map location, zoom level, date range, bands, or other parameters - think about</span>
<span class="s2">        what went wrong in the previous attempt and make the change that&#39;s most likely</span>
<span class="s2">        to improve the score.</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="c1"># Class for LLM chat with function calling</span>

        <span class="n">gemini_tools</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">set_center</span><span class="p">,</span>
            <span class="n">show_layer</span><span class="p">,</span>
            <span class="n">analyze_image</span><span class="p">,</span>
            <span class="n">inner_monologue</span><span class="p">,</span>
            <span class="n">get_dataset_description</span><span class="p">,</span>
            <span class="n">score_response</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="k">class</span> <span class="nc">Gemini</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Gemini LLM.&quot;&quot;&quot;</span>

            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="n">system_prompt</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s2">&quot;gemini-1.5-pro-latest&quot;</span>
            <span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">tools</span><span class="p">:</span>
                    <span class="n">tools</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_text_model</span> <span class="o">=</span> <span class="n">genai</span><span class="o">.</span><span class="n">GenerativeModel</span><span class="p">(</span>
                    <span class="n">model_name</span><span class="o">=</span><span class="n">model_name</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="n">tools</span>
                <span class="p">)</span>

                <span class="n">initial_messages</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">Content</span><span class="p">(</span>
                    <span class="n">role</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">parts</span><span class="o">=</span><span class="p">[</span><span class="n">glm</span><span class="o">.</span><span class="n">Part</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">system_prompt</span><span class="p">)]</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_chat_proxy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_model</span><span class="o">.</span><span class="n">start_chat</span><span class="p">(</span>
                    <span class="n">history</span><span class="o">=</span><span class="n">initial_messages</span><span class="p">,</span> <span class="n">enable_automatic_function_calling</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>

            <span class="k">def</span> <span class="nf">ask</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">question</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">sleep_duration</span> <span class="o">=</span> <span class="mi">10</span>
                        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_text_model</span><span class="o">.</span><span class="n">generate_content</span><span class="p">(</span>
                            <span class="n">question</span> <span class="o">+</span> <span class="n">condition</span>
                        <span class="p">)</span>
                        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
                    <span class="k">except</span> <span class="n">genai</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">generation_types</span><span class="o">.</span><span class="n">StopCandidateException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span>
                            <span class="n">glm</span><span class="o">.</span><span class="n">Candidate</span><span class="o">.</span><span class="n">FinishReason</span><span class="o">.</span><span class="n">RECITATION</span>
                            <span class="o">==</span> <span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">finish_reason</span>
                        <span class="p">):</span>
                            <span class="n">condition</span> <span class="o">=</span> <span class="p">(</span>
                                <span class="s2">&quot;Previous attempt returned a RECITATION error. &quot;</span>
                                <span class="s2">&quot;Rephrase the answer to avoid it.&quot;</span>
                            <span class="p">)</span>
                        <span class="k">with</span> <span class="n">chat_output</span><span class="p">:</span>
                            <span class="n">command_input</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;🆁&quot;</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">with</span> <span class="n">chat_output</span><span class="p">:</span>
                            <span class="n">command_input</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;🤔&quot;</span>
                        <span class="k">continue</span>
                    <span class="k">except</span> <span class="p">(</span>
                        <span class="n">google</span><span class="o">.</span><span class="n">api_core</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">TooManyRequests</span><span class="p">,</span>
                        <span class="n">google</span><span class="o">.</span><span class="n">api_core</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">DeadlineExceeded</span><span class="p">,</span>
                    <span class="p">):</span>
                        <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                            <span class="n">command_input</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;💤&quot;</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">sleep_duration</span><span class="p">)</span>
                        <span class="k">continue</span>
                    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Response </span><span class="si">{</span><span class="n">response</span><span class="si">}</span><span class="s2"> led to error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="nb">breakpoint</span><span class="p">()</span>
                        <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">def</span> <span class="nf">chat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">question</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;Adds a question to the ongoing chat session.&quot;&quot;&quot;</span>
                <span class="c1"># Always delay a bit to reduce the chance for rate-limiting errors.</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">condition</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">sleep_duration</span> <span class="o">=</span> <span class="mi">10</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_chat_proxy</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span>
                            <span class="n">question</span> <span class="o">+</span> <span class="n">condition</span><span class="p">,</span>
                            <span class="n">generation_config</span><span class="o">=</span><span class="p">{</span>
                                <span class="s2">&quot;temperature&quot;</span><span class="p">:</span> <span class="n">temperature</span><span class="p">,</span>
                                <span class="c1"># Use a generous but limited output size to encourage in-depth</span>
                                <span class="c1"># replies.</span>
                                <span class="s2">&quot;max_output_tokens&quot;</span><span class="p">:</span> <span class="mi">5000</span><span class="p">,</span>
                            <span class="p">},</span>
                        <span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">parts</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                                <span class="s2">&quot;Cannot get analysis with reason&quot;</span>
                                <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">candidates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">finish_reason</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, terminating&quot;</span>
                            <span class="p">)</span>
                    <span class="k">except</span> <span class="n">genai</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">generation_types</span><span class="o">.</span><span class="n">StopCandidateException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">(</span>
                            <span class="n">glm</span><span class="o">.</span><span class="n">Candidate</span><span class="o">.</span><span class="n">FinishReason</span><span class="o">.</span><span class="n">RECITATION</span>
                            <span class="o">==</span> <span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">finish_reason</span>
                        <span class="p">):</span>
                            <span class="n">condition</span> <span class="o">=</span> <span class="p">(</span>
                                <span class="s2">&quot;Previous attempt returned a RECITATION error. &quot;</span>
                                <span class="s2">&quot;Rephrase the answer to avoid it.&quot;</span>
                            <span class="p">)</span>
                        <span class="k">with</span> <span class="n">chat_output</span><span class="p">:</span>
                            <span class="n">command_input</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;🆁&quot;</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">with</span> <span class="n">chat_output</span><span class="p">:</span>
                            <span class="n">command_input</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;🤔&quot;</span>
                        <span class="k">continue</span>
                    <span class="k">except</span> <span class="p">(</span>
                        <span class="n">google</span><span class="o">.</span><span class="n">api_core</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">TooManyRequests</span><span class="p">,</span>
                        <span class="n">google</span><span class="o">.</span><span class="n">api_core</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">DeadlineExceeded</span><span class="p">,</span>
                    <span class="p">):</span>
                        <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                            <span class="n">command_input</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;💤&quot;</span>
                        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
                        <span class="k">continue</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
                    <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Response </span><span class="si">{</span><span class="n">response</span><span class="si">}</span><span class="s2"> led to the error </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">model</span> <span class="o">=</span> <span class="n">Gemini</span><span class="p">(</span><span class="n">system_prompt</span><span class="p">,</span> <span class="n">gemini_tools</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="n">gemini_model</span><span class="p">)</span>
        <span class="n">analysis_model</span> <span class="o">=</span> <span class="n">Gemini</span><span class="p">(</span><span class="n">scoring_system_prompt</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="n">gemini_model</span><span class="p">)</span>

        <span class="c1"># UI functions</span>

        <span class="k">def</span> <span class="nf">set_cursor_waiting</span><span class="p">():</span>
            <span class="n">js_code</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            document.querySelector(&#39;body&#39;).style.cursor = &#39;wait&#39;;</span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;script&gt;</span><span class="si">{</span><span class="n">js_code</span><span class="si">}</span><span class="s2">&lt;/script&gt;&quot;</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">set_cursor_default</span><span class="p">():</span>
            <span class="n">js_code</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            document.querySelector(&#39;body&#39;).style.cursor = &#39;default&#39;;</span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&lt;script&gt;</span><span class="si">{</span><span class="n">js_code</span><span class="si">}</span><span class="s2">&lt;/script&gt;&quot;</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">on_submit</span><span class="p">(</span><span class="n">widget</span><span class="p">):</span>
            <span class="c1"># global map_dirty</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map_dirty</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">command_input</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;❓&quot;</span>
            <span class="n">command</span> <span class="o">=</span> <span class="n">widget</span><span class="o">.</span><span class="n">value</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">command</span><span class="p">:</span>
                <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;go on&quot;</span>
            <span class="k">with</span> <span class="n">chat_output</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt; &quot;</span> <span class="o">+</span> <span class="n">command</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">command</span> <span class="o">!=</span> <span class="s2">&quot;go on&quot;</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">debug_output</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&gt; &quot;</span> <span class="o">+</span> <span class="n">command</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">widget</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">set_cursor_waiting</span><span class="p">()</span>
            <span class="n">command_input</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;🤔&quot;</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">chat</span><span class="p">(</span><span class="n">command</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_dirty</span><span class="p">:</span>
                <span class="n">command_input</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;🙏&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">command_input</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;❓&quot;</span>
            <span class="n">set_cursor_default</span><span class="p">()</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">response</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="s2">&quot;&lt;EMPTY RESPONSE, HIT ENTER&gt;&quot;</span>
            <span class="k">with</span> <span class="n">chat_output</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">response</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">command_input</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="n">command_input</span><span class="o">.</span><span class="n">on_submit</span><span class="p">(</span><span class="n">on_submit</span><span class="p">)</span>

        <span class="c1"># UI layout</span>

        <span class="c1"># Arrange the chat history and input in a vertical box</span>
        <span class="n">chat_ui</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">(</span>
            <span class="p">[</span><span class="n">image_widget</span><span class="p">,</span> <span class="n">chat_output</span><span class="p">],</span>
            <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="s2">&quot;420px&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">widget_height</span><span class="p">),</span>
        <span class="p">)</span>

        <span class="n">chat_output</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span>
            <span class="n">width</span><span class="o">=</span><span class="s2">&quot;400px&quot;</span>
        <span class="p">)</span>  <span class="c1"># Fixed width for the left control</span>
        <span class="n">m</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">flex</span><span class="o">=</span><span class="s2">&quot;1 1 auto&quot;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">widget_height</span><span class="p">)</span>

        <span class="n">table</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">HBox</span><span class="p">(</span>
            <span class="p">[</span><span class="n">chat_ui</span><span class="p">,</span> <span class="n">debug_output</span><span class="p">,</span> <span class="n">m</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">(</span><span class="n">align_items</span><span class="o">=</span><span class="s2">&quot;flex-start&quot;</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">message_widget</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Output</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">message_widget</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;❓ = waiting for user input&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🙏 = waiting for user to hit enter after calling set_center()&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🤔 = thinking&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;💤 = sleeping due to retries&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🆁 = Gemini recitation error&quot;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="p">[</span><span class="n">table</span><span class="p">,</span> <span class="n">command_input</span><span class="p">,</span> <span class="n">message_widget</span><span class="p">],</span> <span class="n">layout</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;overflow&quot;</span><span class="p">:</span> <span class="s2">&quot;hidden&quot;</span><span class="p">}</span>
        <span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">












  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="geemap.ai.PrecomputedEmbeddings" class="doc doc-heading">
        <code>
PrecomputedEmbeddings            (<span title="langchain_core.embeddings.embeddings.Embeddings">Embeddings</span>)
        </code>



<a href="#geemap.ai.PrecomputedEmbeddings" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Class for handling precomputed embeddings.</p>

        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">PrecomputedEmbeddings</span><span class="p">(</span><span class="n">Embeddings</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class for handling precomputed embeddings.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embeddings_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the PrecomputedEmbeddings.</span>

<span class="sd">        Args:</span>
<span class="sd">            embeddings_dict (Dict[str, List[float]]): A dictionary mapping texts to their embeddings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">embeddings_dict</span> <span class="o">=</span> <span class="n">embeddings_dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">TextEmbeddingModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;google/text-embedding-004&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">embed_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Embeds a list of documents.</span>

<span class="sd">        Args:</span>
<span class="sd">            texts (List[str]): The list of texts to embed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[List[float]]: The list of embeddings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddings_dict</span><span class="p">[</span><span class="n">text</span><span class="p">]</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">embed_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Embeds a query text.</span>

<span class="sd">        Args:</span>
<span class="sd">            text (str): The query text to embed.</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[float]: The embedding of the query text.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_embeddings</span><span class="p">([</span><span class="n">text</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">embeddings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.PrecomputedEmbeddings.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embeddings_dict</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

<a href="#geemap.ai.PrecomputedEmbeddings.__init__" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Initializes the PrecomputedEmbeddings.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>embeddings_dict</code></td>
        <td><code>Dict[str, List[float]]</code></td>
        <td><p>A dictionary mapping texts to their embeddings.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embeddings_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the PrecomputedEmbeddings.</span>

<span class="sd">    Args:</span>
<span class="sd">        embeddings_dict (Dict[str, List[float]]): A dictionary mapping texts to their embeddings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">embeddings_dict</span> <span class="o">=</span> <span class="n">embeddings_dict</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">TextEmbeddingModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;google/text-embedding-004&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.PrecomputedEmbeddings.embed_documents" class="doc doc-heading">
<code class="highlight language-python"><span class="n">embed_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">)</span></code>


<a href="#geemap.ai.PrecomputedEmbeddings.embed_documents" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Embeds a list of documents.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>texts</code></td>
        <td><code>List[str]</code></td>
        <td><p>The list of texts to embed.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[List[float]]</code></td>
      <td><p>The list of embeddings.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">embed_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">texts</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Embeds a list of documents.</span>

<span class="sd">    Args:</span>
<span class="sd">        texts (List[str]): The list of texts to embed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[float]]: The list of embeddings.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">embeddings_dict</span><span class="p">[</span><span class="n">text</span><span class="p">]</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">texts</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="geemap.ai.PrecomputedEmbeddings.embed_query" class="doc doc-heading">
<code class="highlight language-python"><span class="n">embed_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></code>


<a href="#geemap.ai.PrecomputedEmbeddings.embed_query" class="headerlink" title="Permanent link">&para;</a></h3>

    <div class="doc doc-contents ">

      <p>Embeds a query text.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>text</code></td>
        <td><code>str</code></td>
        <td><p>The query text to embed.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>List[float]</code></td>
      <td><p>The embedding of the query text.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">embed_query</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Embeds a query text.</span>

<span class="sd">    Args:</span>
<span class="sd">        text (str): The query text to embed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[float]: The embedding of the query text.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">embeddings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_embeddings</span><span class="p">([</span><span class="n">text</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">embeddings</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>




  <div class="doc doc-object doc-function">



<h2 id="geemap.ai.explain_relevance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">explain_relevance</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">catalog</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;gemini-1.5-pro-latest&#39;</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#geemap.ai.explain_relevance" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Prompts LLM to explain the relevance of a dataset to a query.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query</code></td>
        <td><code>str</code></td>
        <td><p>The user's query.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>dataset_id</code></td>
        <td><code>str</code></td>
        <td><p>The ID of the dataset.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>catalog</code></td>
        <td><code>Catalog</code></td>
        <td><p>The catalog containing the dataset.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>model_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the model to use. Defaults to "gemini-1.5-pro-latest".</p></td>
        <td><code>&#39;gemini-1.5-pro-latest&#39;</code></td>
      </tr>
      <tr>
        <td><code>stream</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to stream the response. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The explanation of the dataset's relevance to the query.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">explain_relevance</span><span class="p">(</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">dataset_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">catalog</span><span class="p">:</span> <span class="n">Catalog</span><span class="p">,</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gemini-1.5-pro-latest&quot;</span><span class="p">,</span>
    <span class="n">stream</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prompts LLM to explain the relevance of a dataset to a query.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str): The user&#39;s query.</span>
<span class="sd">        dataset_id (str): The ID of the dataset.</span>
<span class="sd">        catalog (Catalog): The catalog containing the dataset.</span>
<span class="sd">        model_name (str): The name of the model to use. Defaults to &quot;gemini-1.5-pro-latest&quot;.</span>
<span class="sd">        stream (bool): Whether to stream the response. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The explanation of the dataset&#39;s relevance to the query.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">stac_json</span> <span class="o">=</span> <span class="n">catalog</span><span class="o">.</span><span class="n">get_collection</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">)</span><span class="o">.</span><span class="n">stac_json</span>
    <span class="k">return</span> <span class="n">explain_relevance_from_stac_json</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">stac_json</span><span class="p">,</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">stream</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.ai.explain_relevance_from_stac_json" class="doc doc-heading">
<code class="highlight language-python"><span class="n">explain_relevance_from_stac_json</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">stac_json</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;gemini-1.5-pro-latest&#39;</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>


<a href="#geemap.ai.explain_relevance_from_stac_json" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Prompts LLM to explain the relevance of a dataset to a query using its STAC JSON.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>query</code></td>
        <td><code>str</code></td>
        <td><p>The user's query.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>stac_json</code></td>
        <td><code>Dict[str, Any]</code></td>
        <td><p>The STAC JSON of the dataset.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>model_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the model to use. Defaults to "gemini-1.5-pro-latest".</p></td>
        <td><code>&#39;gemini-1.5-pro-latest&#39;</code></td>
      </tr>
      <tr>
        <td><code>stream</code></td>
        <td><code>bool</code></td>
        <td><p>Whether to stream the response. Defaults to False.</p></td>
        <td><code>False</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The explanation of the dataset's relevance to the query.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span>
    <span class="n">stop</span><span class="o">=</span><span class="n">stop_after_attempt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">wait</span><span class="o">=</span><span class="n">wait_exponential</span><span class="p">(</span><span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">retry</span><span class="o">=</span><span class="n">retry_if_exception_type</span><span class="p">(</span>
        <span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">,</span> <span class="ne">ConnectionError</span><span class="p">)</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">explain_relevance_from_stac_json</span><span class="p">(</span>
    <span class="n">query</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">stac_json</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gemini-1.5-pro-latest&quot;</span><span class="p">,</span>
    <span class="n">stream</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prompts LLM to explain the relevance of a dataset to a query using its STAC JSON.</span>

<span class="sd">    Args:</span>
<span class="sd">        query (str): The user&#39;s query.</span>
<span class="sd">        stac_json (Dict[str, Any]): The STAC JSON of the dataset.</span>
<span class="sd">        model_name (str): The name of the model to use. Defaults to &quot;gemini-1.5-pro-latest&quot;.</span>
<span class="sd">        stream (bool): Whether to stream the response. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The explanation of the dataset&#39;s relevance to the query.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">stac_json_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">stac_json</span><span class="p">)</span>

    <span class="n">prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  I am an Earth Engine user contemplating using a dataset to support</span>
<span class="s2">  my investigation of the following query. Provide a concise, paragraph-long</span>
<span class="s2">  summary explaining why this dataset may be a good fit for my use case.</span>
<span class="s2">  If it does not seem like an appropriate dataset, say so.</span>
<span class="s2">  If relevant, call attention to a max of 3 bands that may be of particular interest.</span>
<span class="s2">  Weigh the tradeoffs between temporal and spatial resolution, particularly</span>
<span class="s2">  if the original query specifies regions of interest, time periods, or</span>
<span class="s2">  frequency of data collection. If I have not specified any</span>
<span class="s2">  spatial constraints, do your best based on the nature of their query. For example,</span>
<span class="s2">  if I&#39;m wanting to study something small, like buildings, I will likely need good spatial resolution.</span>

<span class="s2">  Here is the original query:</span>
<span class="s2">  </span><span class="si">{</span><span class="n">query</span><span class="si">}</span>

<span class="s2">  Here is the stac json metadata for the dataset:</span>
<span class="s2">  </span><span class="si">{</span><span class="n">stac_json_str</span><span class="si">}</span>
<span class="s2">  &quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">genai</span><span class="o">.</span><span class="n">GenerativeModel</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_content</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">stream</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">stream</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.ai.fix_ee_python_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">fix_ee_python_code</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">ee</span><span class="p">,</span> <span class="n">geemap_instance</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;gemini-1.5-pro-latest&#39;</span><span class="p">)</span></code>


<a href="#geemap.ai.fix_ee_python_code" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Asks a model to do ee python code correction in the event of error.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>code</code></td>
        <td><code>str</code></td>
        <td><p>The Earth Engine Python code to fix.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ee</code></td>
        <td><code>Any</code></td>
        <td><p>The Earth Engine module.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>geemap_instance</code></td>
        <td><code>Map</code></td>
        <td><p>The geemap instance.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>model_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the model to use. Defaults to "gemini-1.5-pro-latest".</p></td>
        <td><code>&#39;gemini-1.5-pro-latest&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>str</code></td>
      <td><p>The corrected Earth Engine Python code.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span>
    <span class="n">stop</span><span class="o">=</span><span class="n">stop_after_attempt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">wait</span><span class="o">=</span><span class="n">wait_exponential</span><span class="p">(</span><span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">retry</span><span class="o">=</span><span class="n">retry_if_exception_type</span><span class="p">(</span>
        <span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">,</span> <span class="ne">ConnectionError</span><span class="p">)</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">fix_ee_python_code</span><span class="p">(</span>
    <span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ee</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">geemap_instance</span><span class="p">:</span> <span class="n">Map</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gemini-1.5-pro-latest&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Asks a model to do ee python code correction in the event of error.</span>

<span class="sd">    Args:</span>
<span class="sd">        code (str): The Earth Engine Python code to fix.</span>
<span class="sd">        ee (Any): The Earth Engine module.</span>
<span class="sd">        geemap_instance (Map): The geemap instance.</span>
<span class="sd">        model_name (str): The name of the model to use. Defaults to &quot;gemini-1.5-pro-latest&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The corrected Earth Engine Python code.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">create_error_prompt</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">error_msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">      You are an extremely laconic code correction robot.</span>
<span class="s2">      I am attempting to execute the following snippet of python Earth Engine code,</span>
<span class="s2">      using a geemap instance:</span>

<span class="s2">      ```</span>
<span class="s2">        </span><span class="si">{</span><span class="n">code</span><span class="si">}</span>
<span class="s2">      ```</span>

<span class="s2">      I have encountered the following error, please fix it. In 1-2 sentences,</span>
<span class="s2">      explain your debugging thought process in the &#39;thoughts&#39; field. Note that</span>
<span class="s2">      the setOptions method exists only in the ee javascript library. Code</span>
<span class="s2">      referencing that method can be removed.</span>

<span class="s2">      Include the complete revised code snippet in the code field.</span>
<span class="s2">      Do not provide any other comentary in the code field. Do not add any new</span>
<span class="s2">      imports to the code snippet.</span>

<span class="s2">      </span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">generation_config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;response_mime_type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
        <span class="s2">&quot;response_schema&quot;</span><span class="p">:</span> <span class="n">CodeThoughts</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">model</span> <span class="o">=</span> <span class="n">genai</span><span class="o">.</span><span class="n">GenerativeModel</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">generation_config</span><span class="o">=</span><span class="n">generation_config</span><span class="p">)</span>

    <span class="n">max_attempts</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">total_attempts</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">broken</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">total_attempts</span> <span class="o">&lt;</span> <span class="n">max_attempts</span> <span class="ow">and</span> <span class="n">broken</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">run_ee_code</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">ee</span><span class="p">,</span> <span class="n">geemap_instance</span><span class="p">)</span>
            <span class="c1"># logging.warning(f&#39;Code success! after {total_attempts} try.&#39;)</span>
            <span class="k">return</span> <span class="n">code</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Code execution error, asking Gemini for help.&quot;</span><span class="p">)</span>

            <span class="n">gemini_json_fail</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">while</span> <span class="n">gemini_json_fail</span><span class="p">:</span>
                <span class="n">response</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_content</span><span class="p">(</span><span class="n">create_error_prompt</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">code_thoughts</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
                    <span class="n">gemini_json_fail</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">except</span> <span class="n">json</span><span class="o">.</span><span class="n">JSONDecodeError</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="n">total_attempts</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">code</span> <span class="o">=</span> <span class="n">code_thoughts</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">]</span>
            <span class="n">thoughts</span> <span class="o">=</span> <span class="n">code_thoughts</span><span class="p">[</span><span class="s2">&quot;thoughts&quot;</span><span class="p">]</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gemini thoughts: </span><span class="se">\n</span><span class="si">{</span><span class="n">thoughts</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># logging.warning(f&#39;Gemini new code: {code}&#39;)</span>
            <span class="k">if</span> <span class="n">total_attempts</span> <span class="o">==</span> <span class="n">max_attempts</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to fix code after </span><span class="si">{</span><span class="n">max_attempts</span><span class="si">}</span><span class="s2"> attempts.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.ai.is_valid_question" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_valid_question</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="n">model_name</span><span class="o">=</span><span class="s1">&#39;gemini-1.5-pro-latest&#39;</span><span class="p">)</span></code>


<a href="#geemap.ai.is_valid_question" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Filters out questions that cannot be answered by a dataset search tool.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>question</code></td>
        <td><code>str</code></td>
        <td><p>The user's question.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>model_name</code></td>
        <td><code>str</code></td>
        <td><p>The name of the model to use. Defaults to "gemini-1.5-pro-latest".</p></td>
        <td><code>&#39;gemini-1.5-pro-latest&#39;</code></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the question is valid, False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@retry</span><span class="p">(</span>
    <span class="n">stop</span><span class="o">=</span><span class="n">stop_after_attempt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">wait</span><span class="o">=</span><span class="n">wait_exponential</span><span class="p">(</span><span class="n">multiplier</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">retry</span><span class="o">=</span><span class="n">retry_if_exception_type</span><span class="p">(</span>
        <span class="p">(</span><span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">RequestException</span><span class="p">,</span> <span class="ne">ConnectionError</span><span class="p">)</span>
    <span class="p">),</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">is_valid_question</span><span class="p">(</span><span class="n">question</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">model_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;gemini-1.5-pro-latest&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filters out questions that cannot be answered by a dataset search tool.</span>

<span class="sd">    Args:</span>
<span class="sd">        question (str): The user&#39;s question.</span>
<span class="sd">        model_name (str): The name of the model to use. Defaults to &quot;gemini-1.5-pro-latest&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the question is valid, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">  You are a tool whose job is to determine whether or not the following question</span>
<span class="s2">  relates even in a small way to geospatial datasets.  Please provide a single</span>
<span class="s2">  word answer either True or False.</span>

<span class="s2">  For example, if the original query is &quot;hello&quot; - you should answer False. If</span>
<span class="s2">  the original query is &quot;cheese futures&quot; you should still answer True because</span>
<span class="s2">  the user could be interested in cheese production, and therefore agricultural</span>
<span class="s2">  land where cattle might be raised.</span>

<span class="s2">  Here is the original query:</span>
<span class="s2">  </span><span class="si">{</span><span class="n">question</span><span class="si">}</span>
<span class="s2">  &quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">genai</span><span class="o">.</span><span class="n">GenerativeModel</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generate_content</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span>
    <span class="c1"># Err on the side of returning True</span>
    <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;false&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.ai.make_langchain_index" class="doc doc-heading">
<code class="highlight language-python"><span class="n">make_langchain_index</span><span class="p">(</span><span class="n">embeddings_df</span><span class="p">)</span></code>


<a href="#geemap.ai.make_langchain_index" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Creates an index from a dataframe of precomputed embeddings.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>embeddings_df</code></td>
        <td><code>pd.DataFrame</code></td>
        <td><p>The dataframe containing precomputed embeddings.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>VectorStoreIndexWrapper</code></td>
      <td><p>The vector store index wrapper.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">make_langchain_index</span><span class="p">(</span><span class="n">embeddings_df</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">VectorStoreIndexWrapper</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates an index from a dataframe of precomputed embeddings.</span>

<span class="sd">    Args:</span>
<span class="sd">        embeddings_df (pd.DataFrame): The dataframe containing precomputed embeddings.</span>

<span class="sd">    Returns:</span>
<span class="sd">        VectorStoreIndexWrapper: The vector store index wrapper.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Create a dictionary mapping texts to their embeddings</span>
    <span class="n">embeddings_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">embeddings_df</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="n">embeddings_df</span><span class="p">[</span><span class="s2">&quot;embedding&quot;</span><span class="p">]))</span>

    <span class="c1"># Create our custom embeddings class</span>
    <span class="n">precomputed_embeddings</span> <span class="o">=</span> <span class="n">PrecomputedEmbeddings</span><span class="p">(</span><span class="n">embeddings_dict</span><span class="p">)</span>

    <span class="c1"># Create Langchain Document objects</span>
    <span class="n">documents</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">embeddings_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">page_content</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;summary&quot;</span><span class="p">],</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]}</span>
        <span class="n">documents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Document</span><span class="p">(</span><span class="n">page_content</span><span class="o">=</span><span class="n">page_content</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">))</span>

    <span class="c1"># Create the VectorstoreIndexCreator</span>
    <span class="n">index_creator</span> <span class="o">=</span> <span class="n">VectorstoreIndexCreator</span><span class="p">(</span><span class="n">embedding</span><span class="o">=</span><span class="n">precomputed_embeddings</span><span class="p">)</span>

    <span class="c1"># Create the index</span>
    <span class="k">return</span> <span class="n">index_creator</span><span class="o">.</span><span class="n">from_documents</span><span class="p">(</span><span class="n">documents</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.ai.matches_datetime" class="doc doc-heading">
<code class="highlight language-python"><span class="n">matches_datetime</span><span class="p">(</span><span class="n">collection_interval</span><span class="p">,</span> <span class="n">query_datetime</span><span class="p">)</span></code>


<a href="#geemap.ai.matches_datetime" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Checks if the collection's datetime interval matches the query datetime.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>collection_interval</code></td>
        <td><code>Tuple[datetime.datetime, Optional[datetime.datetime]]</code></td>
        <td><p>Temporal interval of the collection.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>query_datetime</code></td>
        <td><code>datetime.datetime</code></td>
        <td><p>A datetime coming from a query.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the datetime interval matches, False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">matches_datetime</span><span class="p">(</span>
    <span class="n">collection_interval</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">]],</span>
    <span class="n">query_datetime</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the collection&#39;s datetime interval matches the query datetime.</span>

<span class="sd">    Args:</span>
<span class="sd">        collection_interval (Tuple[datetime.datetime, Optional[datetime.datetime]]):</span>
<span class="sd">            Temporal interval of the collection.</span>
<span class="sd">        query_datetime (datetime.datetime): A datetime coming from a query.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the datetime interval matches, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">collection_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># End date should always be set in STAC JSON files, but just in case...</span>
        <span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">UTC</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">end_date</span> <span class="o">=</span> <span class="n">collection_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">collection_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">query_datetime</span> <span class="o">&lt;=</span> <span class="n">end_date</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.ai.matches_interval" class="doc doc-heading">
<code class="highlight language-python"><span class="n">matches_interval</span><span class="p">(</span><span class="n">collection_interval</span><span class="p">,</span> <span class="n">query_interval</span><span class="p">)</span></code>


<a href="#geemap.ai.matches_interval" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Checks if the collection's datetime interval matches the query datetime interval.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>collection_interval</code></td>
        <td><code>Tuple[datetime.datetime, datetime.datetime]</code></td>
        <td><p>Temporal interval of the collection.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>query_interval</code></td>
        <td><code>Tuple[datetime.datetime, datetime.datetime]</code></td>
        <td><p>A tuple
with the query interval start and end.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>bool</code></td>
      <td><p>True if the datetime interval matches, False otherwise.</p></td>
    </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">matches_interval</span><span class="p">(</span>
    <span class="n">collection_interval</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">],</span>
    <span class="n">query_interval</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Checks if the collection&#39;s datetime interval matches the query datetime interval.</span>

<span class="sd">    Args:</span>
<span class="sd">        collection_interval (Tuple[datetime.datetime, datetime.datetime]):</span>
<span class="sd">            Temporal interval of the collection.</span>
<span class="sd">        query_interval (Tuple[datetime.datetime, datetime.datetime]): A tuple</span>
<span class="sd">            with the query interval start and end.</span>

<span class="sd">    Returns:</span>
<span class="sd">        bool: True if the datetime interval matches, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">start_query</span><span class="p">,</span> <span class="n">end_query</span> <span class="o">=</span> <span class="n">query_interval</span>
    <span class="n">start_collection</span><span class="p">,</span> <span class="n">end_collection</span> <span class="o">=</span> <span class="n">collection_interval</span>
    <span class="k">if</span> <span class="n">end_collection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># End date should always be set in STAC JSON files, but just in case...</span>
        <span class="n">end_collection</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">tz</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">UTC</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">end_query</span> <span class="o">&gt;</span> <span class="n">start_collection</span> <span class="ow">and</span> <span class="n">start_query</span> <span class="o">&lt;=</span> <span class="n">end_collection</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-function">



<h2 id="geemap.ai.run_ee_code" class="doc doc-heading">
<code class="highlight language-python"><span class="n">run_ee_code</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">ee</span><span class="p">,</span> <span class="n">geemap_instance</span><span class="p">)</span></code>


<a href="#geemap.ai.run_ee_code" class="headerlink" title="Permanent link">&para;</a></h2>

    <div class="doc doc-contents ">

      <p>Executes Earth Engine Python code within the context of a geemap instance.</p>

<p><strong>Parameters:</strong></p>
<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Type</th>
      <th>Description</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>code</code></td>
        <td><code>str</code></td>
        <td><p>The Earth Engine Python code to execute.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>ee</code></td>
        <td><code>Any</code></td>
        <td><p>The Earth Engine module.</p></td>
        <td><em>required</em></td>
      </tr>
      <tr>
        <td><code>geemap_instance</code></td>
        <td><code>Map</code></td>
        <td><p>The geemap instance.</p></td>
        <td><em>required</em></td>
      </tr>
  </tbody>
</table>
<p><strong>Exceptions:</strong></p>
<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
      <tr>
        <td><code>Exception</code></td>
        <td><p>Re-raises any exception encountered during code execution.</p></td>
      </tr>
  </tbody>
</table>
        <details class="quote">
          <summary>Source code in <code>geemap/ai.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="nd">@tenacity</span><span class="o">.</span><span class="n">retry</span><span class="p">(</span>
    <span class="n">stop</span><span class="o">=</span><span class="n">tenacity</span><span class="o">.</span><span class="n">stop_after_attempt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">wait</span><span class="o">=</span><span class="n">tenacity</span><span class="o">.</span><span class="n">wait_fixed</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">retry</span><span class="o">=</span><span class="n">tenacity</span><span class="o">.</span><span class="n">retry_if_exception_type</span><span class="p">(</span><span class="n">LayerException</span><span class="p">),</span>
    <span class="c1"># before_sleep=lambda retry_state: print(f&quot;LayerException occurred. Retrying in 1 seconds... (Attempt {retry_state.attempt_number}/3)&quot;)</span>
<span class="p">)</span>
<span class="k">def</span> <span class="nf">run_ee_code</span><span class="p">(</span><span class="n">code</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ee</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">geemap_instance</span><span class="p">:</span> <span class="n">Map</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Executes Earth Engine Python code within the context of a geemap instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        code (str): The Earth Engine Python code to execute.</span>
<span class="sd">        ee (Any): The Earth Engine module.</span>
<span class="sd">        geemap_instance (Map): The geemap instance.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Exception: Re-raises any exception encountered during code execution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># geemap appears to have some stray print statements.</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">redirect_stdout</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
            <span class="c1"># Note that sometimes the geemap code uses both &#39;Map&#39; and &#39;m&#39; to refer to a map instance.</span>
            <span class="n">exec</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;ee&quot;</span><span class="p">:</span> <span class="n">ee</span><span class="p">,</span> <span class="s2">&quot;Map&quot;</span><span class="p">:</span> <span class="n">geemap_instance</span><span class="p">,</span> <span class="s2">&quot;m&quot;</span><span class="p">:</span> <span class="n">geemap_instance</span><span class="p">})</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="c1"># Re-raise the exception with the original traceback</span>
        <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">exc_traceback</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()</span>
        <span class="k">raise</span> <span class="n">exc_value</span><span class="o">.</span><span class="n">with_traceback</span><span class="p">(</span><span class="n">exc_traceback</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>






  </div>

    </div>

  </div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-08-14T03:39:53+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-08-14</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-08-14T03:39:53+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-08-14</span>
  </span>

    
    
    
  </aside>


  




                

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020 - 2024 Qiusheng Wu
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/giswqs" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://medium.com/@giswqs" target="_blank" rel="noopener" title="medium.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M180.5 74.262C80.813 74.262 0 155.633 0 256s80.819 181.738 180.5 181.738S361 356.373 361 256 280.191 74.262 180.5 74.262m288.25 10.646c-49.845 0-90.245 76.619-90.245 171.095s40.406 171.1 90.251 171.1 90.251-76.619 90.251-171.1H559c0-94.503-40.4-171.095-90.248-171.095Zm139.506 17.821c-17.526 0-31.735 68.628-31.735 153.274s14.2 153.274 31.735 153.274S640 340.631 640 256c0-84.649-14.215-153.271-31.742-153.271Z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/giswqs" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/giswqs" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://youtube.com/@giswqs" target="_blank" rel="noopener" title="youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.top", "search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.60a45f97.min.js"></script>
      
        <script src="../js/timeago.min.js"></script>
      
        <script src="../js/timeago_mkdocs_material.js"></script>
      
    
  </body>
</html>